---
title: "Is Momentum Real: On the Existence and Influences of Psychological Momentum in Professional Tennis"
author: "Caleb Skinner"
format:
  pdf:
    linestretch: 2
    include-in-header:
      text: |
        \pagenumbering{gobble}
    header-includes: |
        \usepackage{indentfirst}
        \setlength{\parindent}{2em}
        \usepackage[all]{nowidow}
        \hyphenpenalty=10000
    template-partials:
      - toc.tex
linkcolor: black
font-family: Times New Roman
fontsize: "12pt"
tbl-cap-location: "top"
fig-cap-location: "top"
geometry:
      - top=25.4mm
      - left=38.1mm
      - right=25.4mm
      - bottom=25.4mm
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  comment = "#", fig.height = 3, 
  cache = FALSE, collapse = TRUE,
  error = TRUE, echo = FALSE,
  message = FALSE,
  warning = FALSE)
```

```{r libraries, include = FALSE}
library("arrow")
library("here")
library("scales")
library("flextable")
library("tidyverse"); theme_set(theme_minimal())
library("tidymodels")
library("forstringr")
library("fpp3")
library("patchwork")
library("yardstick")
library("janitor")
library("performance")
library("modelsummary")
library("corrr")
library("gt")
```

```{r flextable, include = FALSE}
set_flextable_defaults(
  font.size = 10, theme_fun = theme_apa,
  padding = 3,
  background.color = "#EFEFEF",
  text.align = "center")
```

```{r data, include = FALSE}
cov <- read_parquet(here("covariates.parquet"))
gs <- read_parquet(here("grandslams2.parquet"))
robust <- read_csv(here("mom_exist_robust.csv"))
```

\newpage

\pagenumbering{arabic}
\begin{spacing}{1}
\vspace*{.1mm}
\begin{center}
\setlength{\parskip}{12pt}

CHAPTER ONE

Introduction

\end{center}
\end{spacing}
\setlength{\parskip}{12pt}

"He is feeling hot today"; "she is a streaky shooter"; "the team has seized the momentum." In modern sports culture, individuals liberally attribute results to the momentum effect. These phrases are prevalent in expert analysis, colloquial commentary, and even accounts from the players themselves. But what if these conclusions are inflated? In a landmark study, Gilovich, Vallone, & Tversky (1985) find no evidence for momentum in professional basketball players' shooting even though both fans and players expect past results to be correlated with future results. Several studies affirm this conclusion and find no evidence for momentum in baseball (Albright, 1989; Gould, 1989) and basketball (Vergin, 2000). In response, several researchers narrowed their focus to more specific and controlled circumstances. These recent studies have found evidence for momentum among horseshoe pitchers (Smith, 2003), bowling (Dorsey-Palmateer & Smith, 2004), volleyball (Raab, Gula, & Gigerenzer, 2012), american football (Roebber, Burlingame, & deWinter, 2022), and basketball (Jane, 2023). However, in recent years, professional tennis has served as the most prolific topic for momentum literature. Tennis's repetitive structure and breadth of available data facilitates research. Within the last decade, several papers have discovered evidence for momentum in professional tennis within specific intervals.

\setlength{\parskip}{0pt}

This paper proposes a novel holistic definition and measurement for momentum that describes a player's momentum at any given point throughout an entire match. This measurement allows relationships discovered in several other papers to be integrated and compared in interpretable methods. We seek to synthesize these discoveries in a holistic assessment of momentum in tennis throughout an entire match. Many of the questions we ask and relationships we analyze are not unique to momentum literature, but this is the first paper seeking to incorporate the findings into a single model. Overall, our goal is twofold. First, we aim to assess the existence of momentum in a professional tennis match. Do the results of past points in a tennis match impact future results? Second, we hope to identify the relationships between several features of a tennis point and the momentum of match. What specific circumstances in past points tend to increase or decrease the future trajectory of a match?

For this study, we obtain detailed point-by-point tennis data from Jeff Sackmann's GitHub. After cleaning the data, we have over 1.3 million points from 7715 matches in 77 different tournaments to utilize. The breadth of data allows us to evaluate momentum's behavior in specific circumstances and its relationship with rare events. We begin by visualizing each match with a point-margin curve. We adjust the curve to account for the server of each point, and define momentum as the instantaneous rate of change or derivative of the server adjusted curve. Thus, a player's momentum is measured at each point in the match. In practice, we employ two estimations for the momentum: backward momentum and future momentum. We define backward momentum as the trend of the match entering a point, and the future momentum as the match's trajectory immediately after the point. To measure backward momentum, we exponentially smooth the server adjusted point-margin curve and then approximate the backward derivative with a simple backward gradient of the smoothed curve. Conversely, future momentum is measured with a forward gradient of the forward exponentially smoothed point-margin curve. Both backward and future momentum continuous variables centered at 0 that span from -1 to 1.

Next, we assess the effect of past results on the player's odds of winning the next point. We regress the players' backward momentum on the point victor in a logistic regression model. We control for structural variables like the players' sex, tournament, pre-match betting odds, and server of the point. We find that a half-unit increase in a player's backward momentum corresponds to a 8.03% increase in the odds of the player winning the next point. Interestingly, we find that an increase (or decrease) in backward momentum has a larger impact on men than women. A half-unit increase in a male player's backward momentum corresponds to a 9.85% increase in the odds of winning a point. On the other hand, a half-unit increase in a female player's backward momentum corresponds to a 5.31% increase in the odds of winning a point. The findings for both groups are statistically significant. After verifying the results with a few procedures, we have sufficient evidence to conclude that past results do impact future results. That is, momentum does exist in professional tennis.

In the second stage, we seek to understand the relationship between several events and the future trend of the match. We hope to identify the events that carry a meaningful association. We divide our events into two models; a point-level model full of factors with short-term impact and a game-level model comprised of factors with long-term impact. Together, the two models demonstrate that winning is associated with an increase in future momentum. Tennis is a hierarchical sport, and the model finds that the more significant victories are associated with a larger increase in future momentum. Important events like converting a break point have a strong association with an increase in future momentum, and memorable events like striking an ace or hitting a winner tend to increase future momentum. On the other hand, we find that interruptions in play tend to diminish the association between winning and future momentum. As in the first stage, we find larger effect sizes for men than women. Overall, these results affirm and expand upon the findings of recent momentum literature on professional tennis.

\newpage

\begin{spacing}{1}
\vspace*{.1mm}
\begin{center}
\setlength{\parskip}{12pt}

CHAPTER TWO

LITERATURE REVIEW

\end{center}
\end{spacing}
\setlength{\parskip}{12pt}

It is strikingly easy for one to overestimate the relationship between past and future success. In fact, individuals struggle to identify casual relationships as a whole. People are prone to look for patterns but are, unfortunately, poor “intuitive statisticians.” We identify these patterns, but all too often they are examples of spurious correlation (Kahneman 2011). Why is this? In general, humans misunderstand the nature of random sequences. One tends to underestimate the length and frequency of random strings of wins and losses (Gilovich, Vallone, & Tversky, 1985). In other words, flip 100 coins, and most would underestimate the size of the largest number of consecutive heads or tails. This underestimation leads to improper conclusions. Even when informed that a game is purely random, one tends to deny the independence of successive points (Page & Coates, 2017). Thus, even when individuals know randomness is completely responsible, they still want to draw conclusions. These misconceptions lead individuals to attribute consecutive victories to momentum, when, in fact, randomness is entirely responsible.

\setlength{\parskip}{0pt}

This inward shortcoming is compounded by societal pressures and customs. The frequent and arbitrary colloquial use of momentum in sporting events encourages observers for identifying and emphasizing when they believe teams and players have “seized the momentum” or are “feeling hot” (Vergin, 2000). Observers are looking for momentum. They want to find it. This leads to confirmation bias, a well-known psychological error, where individuals tend to process, interpret, and remember information in a way that is consistent with their existing beliefs (Oswald & Grosjean, 2004). This phenomenon gives the casual observer incentive to notice and remember streaks of consecutive success - or failures - while forgetting interruptions or exceptions. Early research on momentum has supported these biases. An analysis on shooting trends in professional basketball players showed that both fans and players are inclined to believe that a player’s likelihood of making a shot are greater after a make than after a miss. The same study failed to find evidence for any relationship (Gilovich, Vallone, & Tversky, 1985). More recently, Briki et al. (2014) found that observers are prone to overestimate the effects of momentum on table tennis players. The observers expected players to be more highly affected by adverse conditions than they actually were. Altogether, these biases create an environment where events are frequently misclassified as momentum.

Fortunately, many researchers have approached the subject and conducted extensive and creative analysis on the existence and effect of momentum. They have drawn several nuanced conclusions, and their insight has proved fundamental. However, like many complex subjects, comprehensive clarity is scarce. Broadly, there are three overlapping frameworks for explaining momentum: biological, psychological, and economic (Morgulev, 2023).

\begin{spacing}{1}
\setlength{\parskip}{12pt}
\begin{center}

\textit{Biological Framework}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

First, biological researchers have focused their efforts on discovering momentum in the animal kingdom. They suggest that ‘winning’ produces positive hormones that prime animals for future success. This theoretical concept, known as the ‘winner effect’, indicates that past positive winning experiences award individuals a higher likelihood for future victories largely due to inward physiological reactions to winning (Robertson, 2012). In the biological framework, the victory physically improves the animal’s demeanor and skill set. This is because victories emit enhancing hormones like testosterone, estrogen, and cortisol into the body’s bloodstream. This theory has been generally supported by experimental research. For example, testosterone levels increased in humans after victory in the classic video game Tetris and decreased after a loss (Zilioli & Watson, 2014). In a study involving male sprinters, high testosterone levels were positively associated with a lower sprint time (Bezuglov et al., 2023). In other words, high levels of testosterone are found to be linked with increased performance. In addition, these hormones are supposed to increase confidence, aggression, and positivity in the individual. This behavior may intimidate and frighten competitors and position the animal in a mindset and circumstance prepared for future success (Morgulev, 2023). Winning animals are more likely to participate in future competitions, and, therefore, experience success.

Overall, researchers have found existence of the winner effect in several animal species. Jumping spiders’ fighting ability increased after victory (Kasumovic et al., 2010). Fighting behaviors and aggression in pupfish were impacted by victory (Hsu & Wolf, 2001). Previous outcomes directly impacted the probability of victory for lizards (Garcia et al., 2014). In a comprehensive analysis that spanned several animals, the probability of victory nearly doubles for winners when accounting for asymmetries in the competitor’s skill (Rutte et al., 2006). Measuring the winner effect in humans, however, is much more difficult and the results are more nuanced.

\begin{spacing}{1}
\begin{center}
\setlength{\parskip}{12pt}

\textit{Psychological Framework}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

In the second framework, competition and momentum are examined from a purely psychological perspective. Psychologists acknowledge the physiological changes that biologists propose, but their focus is on the psychological factors impacting the competitors (Morgulev, 2023). As such, psychological momentum is associated with confidence and the popular adage ‘success breeds success.’ Typically, this research resides in the domain of sports psychology. Adler & Adler (1978) propose that a series successful events like a steal, dunk, or ace can serve as catalysts of momentum. These catalysts build and contribute to increased confidence and motivation within an individual. Iso-Ahola & Mobily (1980) coined the term psychological momentum to describe the effect of these psychological factors on a competitor. They write “psychological momentum is an added or gained psychological power which changes a person’s view of himself or of others or others’ view of him and of themselves.” Taylor & Demick (1994) contributed heavily to the theory of psychological momentum. They propose a six-stage multidimensional model outlining its progression. This “momentum chain” is as follows: (a) precipitating event, (b) change in cognition, affect, or physiology, (c) change in behavior, (d) increase or decrease in performance, (e) opposite reaction in opponent, and (f) change in outcome. Much of the individual links in the model has yet to be directly empirically verified, but, as predicted, positive preceding events are associated with a large array of cognitive and behavioral benefits. Vallerand & Reid (1988) links psychological momentum with the notion that one is “progressing towards his/her goal” which in turn reinforces feelings of self-confidence, control, and motivation. Self-confidence is supposed to increase attentiveness, concentration, and even the mental and physical effort of competitors (Iso-Ahola & Mobily, 1980). Briki (2017) argue that past success yields behavioral patterns like persistence and self-determination. Initially, Iso-Ahola & Mobily (1980) proposed that, all else equal, the player with the higher psychological momentum receives a competitive advantage. However, years of mixed results has brought uncertainty into that conclusion.

\begin{spacing}{1}
\begin{center}
\setlength{\parskip}{12pt}

\textit{Economic Framework}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

Economists often view momentum from a game theory perspective. They define contests as “games” between two players who earn a payoff from the game. Payoffs are a numerical estimation of the worth of each outcome to each player. Monetary rewards contribute to this payoff, but so do social and intrinsic rewards (Vojnovic, 2015). In these contests, players have the opportunity to exert different levels of effort which affect their chances of receiving each payoff. However, effort is costly and lessens the players payoffs (Morgulev, 2023). Thus, in order to maximize their payoff, players have incentive to minimize effort. Theoretically, this means that the structure and payoff of a game make the players’ effort predictable (Malueg & Yates, 2010).

The structure of a game incorporates the rules, circumstances, and score of the game itself. Each game is comprised of a large sequence of small “battles” (Kovenock & Roberson, 2012). As these battles occur, inevitably one player will have an advantage, shifting the structure of the game. In essence, this shift creates a new game in which one player is closer to winning than the other. The losing player must now expend more effort than his/her counterpart to achieve victory (Morgulev, 2023). Effort is costly, so this new game has asymmetric incentives that impact the players’ predicted effort (Konrad & Kovenock, 2009). This change in effort is known as *strategic momentum*. Strategic momentum ignores inward psychological or physiological factors and instead focuses entirely on the change in the game’s structure.

Mago, Sheremeta, & Yates (2012) give a simple illustration using a best of three contest between two equally-skilled players. At the start, economic theory postulates that both players will exert equal effort. However, after one round, the winning player has an advantage. They must exert enough effort to win one round while the losing player must win two. The leading player, armed with strategic momentum, has more incentive to expend energy and thus has a higher chance of winning the second round. If the players are again tied after two rounds, this economic theory predicts that in round three each player has equal incentive to exert effort- and therefore win. This corroborates with empirical studies, which find that equally-skilled players are equally likely to win a third set in best of three set tennis matches (Malueg & Yates, 2010).

\begin{spacing}{1}
\begin{center}
\setlength{\parskip}{12pt}

\textit{Interactions between the Frameworks}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

While independent, these three frameworks contain several notable similarities and distinctions. The biological and psychological frameworks both emphasize the effect of winning on the individual. The biological framework emphasizes the chemical and physiological changes in the winner, while the psychological framework assesses the behavioral and psychological changes. Morgulev & Avugos (2020) integrate the two frameworks under the term *psychophysiological momentum*.

Strategic momentum, however, is distinct from both other frameworks. Strategic momentum assesses the situation, while biological and psychological momentum evaluate the competitors themselves. Researchers are interested in distinguishing the frameworks, but in most contests, both types of momentum co-exist (Cohen-Zada, Krumer, & Shtudiner, 2017), so separation is difficult. However, several researchers have constructed laboratory experiments or identified natural experiments to isolate strategic and psychological momentum. For example, Mago, Sheremeta, & Yates (2012) conducted a laboratory experiment, using varying prizes as incentives in best of three contests, and they found evidence for strategic momentum but not for psychological momentum. In contrast, an analysis of professional judo tournaments found that judo players arriving at a bronze medal fight after a win are more likely to win than a player arriving after a loss (Cohen-Zada, Krumer, & Shtudiner, 2017). This unique setting lacks strategic momentum, but contains psychological momentum. Likewise, Meier et al. (2020) assess interruptions in tennis contests and find evidence that psychological momentum and not strategic momentum is the main driver of a performance increase. Several researchers, therefore, argue that the value of psychological momentum exceeds that of strategic momentum (Descamps, Ke, & Page, 2022; Morgulev, 2023). The findings of Depken, Gandar, & Shapiro (2022) are more nuanced. They design a model based purely on incentives from strategic momentum and interpret deviations as psychological momentum. Under this interpretation, they find evidence for a *psychological reversal* after set one and weak evidence for psychological momentum after set two. Altogether, strategic and psychophysiological momentum both exist, but the dominance of one over the other often depends on the design and situation of the empirical study.

\begin{spacing}{1}
\begin{center}
\setlength{\parskip}{12pt}

\textit{Procrastination and Anti-Momentum Theory}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

Economic theory is not unanimously convinced that success breeds success. Success leads to favorable, comfortable situations that can dissuade individuals from expending effort towards a future goal. Colloquially, this is known as procrastination. Behavioral economics introduces procrastination into decision making through the concept *hyperbolic-discounting*. Hyperbolic-discounting is a cognitive bias, where individuals tend to value smaller immediate rewards higher than larger future rewards. Phelps & Pollak (1968) introduced the concept, and Laibson (1997) popularized and justified it. He argues that laboratory and field studies demonstrate that humans disproportionately value the future (Ainslie & Haslam, 1992). Laibson writes that the hyperbolic discounting structure “sets up a conflict between today’s preferences, and the preferences that will be held in the future.” In essence, “the hyperbolic discounting approach captures the psychological phenomenon that the present is given special treatment” (Rubinstein, 2003). Shigeta (2022) illustrates hyperbolic discounting by separating the utility and consumption of an agent’s current self from the utility and consumption of his or her future self. If the future is far enough away, the current self effectively treats the future self as a different individual. Psychologically, this inconsistency is categorized as a lack of self-control and a misunderstanding of the importance of the future (Laibson, 1997). Overall, the model has been widely applied to a variety of financial situations like investment planning (Laibson 1997) and corporate finance (Grenadier & Wang, 2007). Evidence has been found to support hyperbolic discounting in the job search market (Paserman, 2008) as well as procrastination, addiction, information acquisition, and self-regulation (Rubinstein, 2003). There is very little empirical research to apply the theory of hyperbolic discounting to contests, but the theory translates. Under the hyperbolic discounting model, individuals value time and energy in the present more highly than in the future. Thus, players with many opportunities to secure victory will be motivated to exert less effort in the early opportunities and potentially “procrastinate” victory.

\begin{spacing}{1}
\begin{center}
\setlength{\parskip}{12pt}

\textit{Momentum in Sports}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

The presence of momentum or “streakiness” in sports has fallen under considerable debate in the last forty years. Gilovich, Vallone, & Tversky (1985) published a landmark report comprehensively rejecting the notion of the “hot hand” in basketball. In both live shooting and free throw attempts, they find no evidence that a made basket positively impacts a player’s chances to make the subsequent shot. In addition, they find no evidence that the number of runs of consecutive makes or misses differs from the predicted number of runs governed entirely by chance. A few years later, Albright (1989) came to a similar conclusion with hitting streaks in baseball. He found that baseball players as a whole do not exhibit streakiness beyond the scope of randomness. In fact, Gould (1989) concluded that Joe DiMaggio’s 56-game hitting streak in 1941 was the only known exception. Vergin (2000) expanded these conclusions to teams as a whole, finding that winning streaks from both professional basketball and professional baseball teams are comparable to the results expected if the games were determined independent of each other. These results and more have led Bar-Eli, Avugos, & Raab (2006) to conclude after an extensive review that little empirical evidence supports the relationship between past and future success.

However, several studies have found empirical evidence for momentum in sports. Smith (2003) found a “hot hand” effect in horseshoe pitchers. He argues that horseshoe competitions have many structural properties that eliminate confounding variables present in other sports. Smith (2003) posits that the small duration between pitches and little strategic complications play a large part in the findings. In a similarly simple game, Dorsey-Palmateer & Smith (2004) found evidence for streakiness in bowling. They found that bowlers are more likely to roll a strike after a series of strikes than a series of non-strikes. Recently, papers have found evidence for momentum in more complex sports. This is potentially a direct result of increased access to large data sets (Jane, 2023). Raab, Gula, & Gigerenzer (2012) find evidence for streakiness in half of the volleyball players and conclude that the hot hand effect exists in volleyball. Shea (2013) finds evidence for streakiness in professional basketball’s three-point contests and professional baseball’s home run derby. Like previous findings, he argues that the simplicity of these games allows for more direct analysis and removes potential structural or strategic challenges. An analysis of the change in win probability in professional football indicates that team’s possessions are dependent and that long streaks of successful drives are more likely than randomness would suggest (Roebber, Burlingame, & deWinter, 2022). In a challenge to Gilovich, Vallone, & Tversky’s foundational paper, Jane (2023) finds evidence for both a hot hand and choking under pressure on free throw attempts in professional basketball.

\begin{spacing}{1}
\begin{center}
\setlength{\parskip}{12pt}

\textit{Momentum in Tennis}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

The game of tennis possesses incredible value for researchers because of its simple and repetitive structure. Players are continually exposed to the same conditions and are not subject to the complex interactions and strategic decisions that impact the dynamic of many team sports (Sarcevic, Vranic, & Pintar, 2021). In addition, tennis has been described as a best-of-n and tug-of-war game (Gauriot & Page, 2019). This hierarchical scoring structure makes it easier to identify asymmetric incentives between the players and assess momentum. In singles, there are always two possible outcomes and two players. This provides two significant empirical advantages. First, after each point in the match, one player always inches closer to his or her goal in a measurable way. Tennis is a zero-sum game; there are no neutral outcomes. Second, the same two players compete for the entire duration of the match. This makes it possible to adjust for any inequality in skill between the two players in a more controlled fashion. These structural benefits and the abundance of available data have made tennis to be an ideal sport to analyze the presence of momentum.

Klaasen & Magnus (2001) delivered the first major contribution towards momentum literature in tennis with the conclusion that points at Wimbledon are not independent and identically distributed. While controlling for the quality of the players, they find that winning the previous point positively impacts players chances of winning the subsequent point. However, they concluded that the deviation is small enough that researchers can safely assume the points are independent and identically distributed.

Other researchers have noticed that not all points in tennis are the same. In his famous book *Winning Ugly*, famous tennis coach Brad Gilbert argues that “specific points and games” have an outsized impact “on the momentum and outcome of the match” (Gilbert & Jamison, 2013). These uniquely impactful points then have a potential to be exploited by researchers to assess their momentum effect. Page & Coates (2017) assessed the effect of long tiebreaks in the first set on future sets. The two players end these sets having played about 78 points, but the outcomes of sets with long tiebreaks are ultimately decided by only two points. Thus, after the set’s conclusion, the two players will have won about the same amount of points, but one player will have emerged with a massive strategic and psychological advantage. In men’s matches, they find that in first set tiebreaks lasting longer than 20 points, the winner of the first set has a 60% chance of winning the second set. They conclude that winning a close set produces momentum. They attribute this advantage to the winner effect.

Similarly, Gauriot & Page (2019) assess the effect of shots landing close to lines on future points. If a player hits a ball that lands one centimeter outside the line, he or she has a 0% chance of winning the point, but if the player hits a ball that lands one centimeter in, he or she has a positive probability of winning the point. Thus, within these few centimeters there is a large discontinuity in the outcome of the point. In men’s matches, they find that shots close to lines give players a higher chance to win the next point. Interestingly, this effect increases when the game score is tied or near its conclusion and falls when the score is asymmetric. Gauriot & Page (2019) conclude that the effect is strongest when the match is close and nearing its end.

Meier et al. (2020) exploit the hierarchical structure of tennis by assessing the effect of breaking the opponent’s serve on future points. Breaks of serve are uncommon and often sufficient in determining the winner of a set (Klaasen & Magnus, 2001). A server’s chance of winning his service game increases by almost 9 percentage points after a break (Meier et al., 2020). However, if players are interrupted by a changeover in between the break and the subsequent service game, the effect is drastically decreased. Meier et al (2020) conclude that psychological momentum - not strategic momentum - primarily causes the effect.

Overall, several studies find a larger momentum effect in men than in women. Depken, Gandar, & Shapiro (2022) analyze the set-level momentum effects and find significant differences in male and female responses in sets one and two of a best-of-three set match. Page & Coates (2017) found a winner effect in men’s players after winning a close tiebreak, but they failed to find a winner effect for women. Gauriot & Page (2019) also fail to find any significant patterns for women’s matches after a shot lands close to the line. They, however, leave open the possibility that momentum exists in women’s tennis. This distinction between male and female contributors aligns with conclusions from other fields (Cohen-Zada, Krumer, & Shtudiner, 2017) and fits with physiological explanations derived from the biological framework (Bezuglov et al., 2023).

\newpage

\begin{spacing}{1}
\begin{center}
\setlength{\parskip}{12pt}

\textit{Summary}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

Altogether, existing research suggests that momentum is difficult to assess. Humans are quick to identify patterns of momentum, but these patterns are frequently spurious. Yet, there is a growing domain of literature that supports the presence of momentum and three frameworks that explain it. The biological framework introduces the winner effect and suggests that winning produces positive hormones that orient the competitor for future success. The psychological framework holds that success breeds confidence, motivation, and general positive feelings that increase concentration, attentiveness, and future success. This process is known as psychological momentum. The economic framework introduces strategic momentum and holds that small victories in a competition change the competition’s structure and motivate winners to exert more energy than losers. However, the economic field is not unanimous. In direct contrast to the strategic momentum, the concept of hyperbolic discounting theorizes that players in successful positions will procrastinate effort to future moments in the competition.

Initial empirical studies in sports found very little support for momentum. Gilovich, Vallone, & Tversky (1985) rejected the notion of the hot hand in basketball, and Albright (1989) dismissed streakiness in baseball hitting. These findings left a mark on the field and at the very least demonstrate that momentum is more nuanced and often less impactful than observers would expect. Recently, an increase in accessible and detailed data has allowed for more specific and nuanced studies on momentum. These studies have contributed to growing evidence for the existence of momentum in sports.

Tennis’s simple and hierarchical structure has provided a suitable ground for empirical studies. Researchers observe changes in momentum after several distinct moments in a match. Klaasen & Magnus (2001) find evidence for momentum after winning a point. Page & Coates (2017) conclude that winning a close set generates momentum for future sets. Gauriot & Page (2019) find that shots landing close to the line generate positive momentum. This effect is strongest when the match is close and nearing its end. Meier et al. (2020) find evidence that a break of serve yields positive momentum, but that interruptions in play dampen momentum. Finally, most of these studies find much stronger evidence for momentum in men’s tennis than in women’s tennis.

\newpage

\begin{spacing}{1}
\setlength{\parskip}{12pt}
\vspace*{.1mm}
\begin{center}

CHAPTER THREE

DATA

\setlength{\parskip}{24pt}

\textit{Acquiring Data}
\end{center}
\end{spacing}
\setlength{\parskip}{0pt}

In order to assess the trends of momentum over the course of a match, we required detailed point-by-point data of a large number of tennis matches. While tennis is iterative and governed by relatively simple scoring, certain unique conditions can only occur a few times in each match. A large number of matches permits us to test the effects of several of these circumstances.

Each year, there are hundreds of professional tennis tournaments awarding millions of dollars in prize money. Yet, the pinnacle of the tennis calendar falls in four Grand Slam events. These four tournaments -- the Australian Open (held in January), French Open (May), Wimbledon (July), and US Open (September) -- offer players the most ranking points, publicity, prize money, and prestige. Players always have incentive to exert effort towards victory, but the incentives are never higher than in the Grand Slams (Crespo et al., 2003). Accordingly, players structure their complex schedules of training, recovery, and competition in order to maximize their performance at these four events. For these reasons, the Grand Slam events serve as the ideal grounds for empirical studies of momentum. Grand Slam events are relatively rare and valuable, so all players should be motivated to put forth substantial effort regardless of their financial situation. Moreover, Grand Slam events possess significantly more resources and content than smaller tournaments. The Grand Slam events each partner with tracking services like IBM or Infosys. This allows for accurate and detailed information of each point.

We acquired point-by-point tennis data from Jeff Sackmann's GitHub page titled "Grand Slam Point-by-Point Data, 2011-present" (Sackmann, 2024). He scraped the data "from the four Grand Slam websites shortly after each event." We used data from both men's and women's singles matches from all four Grand Slams. In 2018, the Australian Open and French Open shifted their partnership from IBM to Infosys. Infosys tracks points differently and has fewer features. This complicates the integration of the data, so we chose to only include matches from the Australian Open and French Open from 2011-2017.

The point-by-point data for each match lacks important information about each player's skill. A strong player could secure a long streak of victories over a weaker player simply because he or she is a superior player (Page & Coates, 2017). Thus, without an appropriate adjustment for skill level, an analysis of momentum can falsely attribute positive momentum to a player that is simply more skillful than his or her opponent. An adjacent page of Jeff Sackmann's GitHub begins to resolve this issue by including the rank of each player before each match. A player's ranking provides a rough- but often inaccurate- estimate of his or her skill level entering a match. A player's ranking is composed of his or her success on the professional tour in the past twelve months. The ranking does not account for the proximity of success, the skill level of previous opponents, or the closeness of matches. In other words, a dominant victory against a top player two weeks prior can be weighted the same as a close victory over a weak player 11 months ago. The ranking can also be slow to react to developments like injuries and age. These inconsistencies allow for luck or misfortune to inhibit a players' ranking from representing their skill level.

A more accurate estimate for the skill level of each player is the match's pre-match betting odds. The match's betting odds is a pre-match assessment of both player's likelihood of victory. Sportsbooks have the resources to develop highly advanced predictive models, and they have the incentives to react to recent results and developments much faster than a player's ranking. For strategic and personal reasons, certain players perform better on different tournaments. Betting odds can account for these nuances. We acquired the pre-match betting odds for each match from Tennis Data (Tennis Data, 2024). Tennis Data features betting odds from two different Sportsbooks: Bet365 and Pinnacles Sports. We added both to our data set.

\begin{spacing}{1}
\begin{center}
\setlength{\parskip}{12pt}

\textit{Cleaning Data}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

The point-by-point data came as 106 csv files, and the betting odds data came as 78 csv files. We cleaned the variable names and joined all the data sets into one. All transformations and computations are performed in R (R Core Team, 2024) and with additional R packages. The data set follows Hadley Wickham's tidy data format (Wickham & Grolemund, 2017).

IBM tracks several useful calculations for each point. Some of the important variables include elapsed time, serve speed, rally length, distance run, serve depth, and return depth. Not all courts, however, have been equipped to calculate all of these complex measurements. Most notably, several matches are not equipped to measure the distance players travel in a point and the length of each points' rally. The most recent tournaments and later rounds have much more complete measuring systems.

Overall, IBM's data collection methods produced very little noticeable missing or inaccurate observations. Missing observations, however, typically have a disproportional impact, because they disrupt the scoring of the entire match. Our data includes 62 of these disrupted matches. Interestingly, most of them are from the French Open. Given the abundance of our data, we chose to remove these 62 matches from the data set. Occasionally, the measuring system stopped tracking a match's data before the conclusion of the match. Our data includes 39 matches without the final point. We chose to retain these incomplete matches, because they still contain long uninterrupted sequences of points. For whatever reason, another 202 matches lacked pre-match betting odds. After removing these from our total, our data set includes 7715 matches and over 1.40 million points.

The computation of backward and future momentum naturally creates missing observations at the beginning and end of each match. For this reason, we removed the first and last few points for each match. These points are likely to hold more variable measurements of momentum, so this loss is not significant. This reduces our data set to 1.36 million points.

\begin{spacing}{1}
\begin{center}
\setlength{\parskip}{12pt}

\textit{Description of Covariates}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

There are several important variables that may impact momentum. We have divided these covariates into three categories: *structural* covariates, *catalytic* covariates, and *reducing* covariates. Structural covariates define the structure and natural conditions of a match. These are the rules under which the players play. Catalytic covariates are events within a match that we hypothesize spark momentum. Reducing covariates are events or rules that can slow or reset momentum.

\noindent{\textit{Structural Covariates}}

The structural covariates define the normal conditions of play. As a rule, any variable that directly impacts a players' probability of winning a point for the entire duration of a match, regardless of the score, is structural. Important structural variables include server, sex, pre-match betting odds, and the tournament of play. One of the difficulties in momentum literature is isolating momentum effect from a mere asymmetry in player skill (Meier et al., 2020). These structural covariates help control for the non-momentum forces that impact a match.

\textit{Server.} One of the most powerful shots in the game of tennis is the serve. Players alternate service games and they hold a large advantage while serving. Over the course of our data, players won 61.41% of points while serving and 74.78% of the games while serving.

\textit{Tournament.} Each of the four Grand Slams hold different characteristics that affect the player's style of play. The surface of the court and common weather conditions can cause the same stroke to travel at different speeds and spin rates. Generally, the conditions at Wimbledon are fastest and those at the French Open are slowest. However, these exact conditions vary from year to year. They are even impacted by the time of day. As seen in @fig-server-by-tournament, these conditions most noticeably impact the players' dominance on the serve.

```{r}
#| label: fig-server-by-tournament
#| fig-cap: "Tournament Impact on Serve Dominance"
gs %>% group_by(tournament) %>%
  summarise(
    sw_point = sum(server == point_victor),
    rw_point = sum(server != point_victor),
    sw_game = sum(server == game_victor & tiebreak == 0),
    rw_game = sum(server != game_victor & game_victor != 0 & tiebreak == 0)) %>%
  mutate(
    tournament = str_remove(tournament, "open"),
    tournament = str_replace(tournament, "aus", "australian"),
    tournament = str_to_title(tournament),
    tournament = str_replace(tournament, "Us", "US")) %>%
  rowwise() %>%
  transmute(
    tournament = factor(tournament, levels = c("Australian", "French", "Wimbledon", "US")),
    Points = sum(sw_point)/(sum(rw_point)+sum(sw_point)),
    Games = sum(sw_game)/(sum(rw_game)+sum(sw_game))) %>%
  pivot_longer(cols = c(Points, Games), names_to = "stat", values_to = "prop") %>%
  ggplot() +
  geom_bar(aes(x = tournament, y = prop, fill = stat), stat = "identity", position = position_dodge2(reverse = TRUE)) +
  labs(y = "", x = "", title = "") +
  scale_y_continuous(labels = scales::percent) +
  scale_fill_discrete(name = "", breaks = c("Points", "Games")) +
  coord_cartesian(ylim = c(.5, .8)) +
  theme(plot.title=element_blank())
```

These changes in conditions lead to a slightly different overall style of play. @tbl-tournament displays descriptive statistics of the styles of play at the tournaments. Rallies are shorter at Wimbledon. Serve speeds and winners are higher at Wimbledon and lower at the French Open. We will use the categorical variable **tournament** to explain this situation.

```{=latex}
\begin{spacing}{1}
```

```{r}
#| label: tbl-tournament
#| tbl-cap: "Tournament Style of Play"

gs %>% group_by(tournament) %>%
  mutate(first_serve = if_else(serve_no == 1, speed_mph, NA),
         second_serve = if_else(serve_no == 2, speed_mph, NA),
         tournament = factor(tournament, levels = c("ausopen", "frenchopen", "wimbledon", "usopen"))
         ) %>%
  summarise(
    "Rally Length" = mean(rally_count, na.rm = TRUE),
    "First Serve Speed" = mean(first_serve, na.rm = TRUE),
    "Second Serve Speed" = mean(second_serve, na.rm = TRUE),
    "Ace Rate" = percent((sum(p1_ace == 1) + sum(p2_ace == 1))/n(), accuracy = .01),
    "Winner Rate" = percent((sum(p1_winner == 1) + sum(p2_winner == 1))/n(), accuracy = .01)) %>%
  mutate(
    across(where(is.numeric), ~round(.x, digits = 2)),
    tournament = recode(tournament,
                        "ausopen" = "Australian Open",
                        "frenchopen" = "French Open",
                        "usopen" = "US Open",
                        "wimbledon" = "Wimbledon")) %>%
  rename("Tournament" = "tournament") %>%
  gt()
  # flextable() %>%
  # align(align = "center", part = "all") %>%
  # width(j = 1, width = 1.2) %>%
  # width(j = c(2:6), width = .95)
```

```{=latex}
\end{spacing}
```

\textit{Sex.} In general, the structural aspects of men's and women's tennis are very similar. In the Grand Slams, men play a best-of-five set match while women play a best-of-three set match. Otherwise, the conditions are exactly same. Still, this small difference impacts our study of trends in momentum over time. Men play more points over the course of a match, so there are more opportunities to observe changes in momentum. Men play an average of 221.6 points per match and women play an average of 139.9 points per match. Thus, while 49.1% of our data set are women's matches (3885 matches), only 37.8% of the points are played by women (543284 points). @fig-match-length displays the match length distribution for men's and women's matches.

```{r}
#| label: fig-match-length
#| fig-cap: "Match Length"
gs %>% filter(match_pt == 1) %>%
  select(sex, point_no, match_id) %>%
  group_by(sex) %>% 
  ggplot() +
  geom_density(aes(x = point_no, group = sex, color = factor(sex))) +
  labs(x = "Points", y = "", title = "", color = "Sex") +
  scale_color_discrete(name = "", labels = c("Women", "Men")) +
  scale_y_continuous(breaks = NULL) +
  coord_cartesian(xlim = c(0,500)) +
  theme(plot.title=element_blank())
```

While the rules are nearly identical, the characteristics of the men's and women's games differ in the relative dominance of the serve. Men tend to win a higher proportion of points while serving than women. Women still have an advantage on their serve, but it is much lower.

```{r}
#| label: fig-server-sex
#| fig-cap: "Server Impact by Sex"
gs %>% group_by(sex) %>%
  summarise(
    sw_point = sum(server == point_victor),
    rw_point = sum(server != point_victor),
    sw_game = sum(server == game_victor & tiebreak == 0),
    rw_game = sum(server != game_victor & game_victor != 0 & tiebreak == 0)) %>%
  rowwise() %>%
  transmute(
    sex = recode(sex, "0" = "Women", "1" = "Men"),
    Points = sum(sw_point)/(sum(rw_point)+sum(sw_point)),
    Games = sum(sw_game)/(sum(rw_game)+sum(sw_game))) %>%
  pivot_longer(cols = c(Points, Games), names_to = "stat", values_to = "prop") %>%
  ggplot() +
  geom_bar(aes(x = sex, y = prop, fill = stat), stat = "identity", position = position_dodge2(reverse = TRUE)) +
  labs(y = "", x = "", title = "") +
  scale_y_continuous(labels = scales::percent) +
  scale_fill_discrete(name = "", breaks = c("Points", "Games")) +
  coord_cartesian(ylim = c(.5, .8)) +
  theme(plot.title=element_blank())
```

\textit{Betting Odds.} Pre-match betting odds are maintained by several sportsbooks for all Grand Slam tennis matches. We selected two sportsbooks, Bet365 and Pinnacle Sports, that employ the European (Decimal) Odds method. Their format is relatively simple. The decimal odds is the value a better receives for a \$1 bet. A better wagering \$100 on a match with decimal odds at 1.01 wins \$101 for a \$1 profit, while a better wagering \$100 on a match with decimal odds at 2.00 wins \$200 for a \$100 profit. Thus, small decimal odds are safe bets on likely winners and large decimal odds are risky bets on unlikely winners.

Fortunately, decimal odds are also easily transformed into an implied probability percentage between 0 and 1 with the equation:

```{=latex}
\begin{spacing}{1}
```

$$\displaystyle \text{Implied Probability} = \frac{1}{\text{decimal odds}} * 100$$

```{=latex}
\end{spacing}
```

Sportsbooks have strong incentive to precisely adjust their betting odds to reflect realistic pre-match win probabilities, so it is safe to assume that the betting odds represent the two players' known strength entering a match. Indeed, in many ways these sportsbooks facilitate a betting market where odds quickly adjust to new information. Literature has shown that pre-game betting odds in the National Football League are exceedingly strong predictors of the eventual outcome (Song, Boulier, & Stekler, 2007). Easton & Uylangco (2010) extend these results to professional tennis and conclude that betting markets are highly efficient.

We perform three logistic regressions (Hosmer, Lemeshow, & Sturdivant, 2013) to compare the predictive power of Bet 365's betting odds, Pinnacle Sport's betting odds, and the player's rankings the outcome of the matches in our data set. In total, the data includes 7711 matches (51.58% men) across 39 tournaments. In order to coerce the data into a symmetric distribution, we transform both decimal odds into an implied win probability for player 1. Both betting odds predictors are converted to implied win probability percentages. There is no natural way to convert the two players' rankings into an implied win probability, so we transform the two players' rankings into the difference between player 1 and player 2's. That is, if player 1 is ranked 1 and player 2 is ranked 30, the variable would hold a value of -29.

```{r, include = FALSE}
bet_analysis <- gs %>% filter(match_pt == 1) %>%
  select(match_id, match_victor, ranking1, ranking2, ps_1, ps_2, b365_1, b365_2) %>%
  mutate(
    match_victor = factor(if_else(match_victor == 2, 0, match_victor)),
    rank_diff = ranking1 - ranking2,
    ps_1_prob = (1/ps_1)*100,
    ps_2_prob = (1/ps_2)*100,
    b365_1_prob = (1/b365_1)*100,
    b365_2_prob = (1/b365_2)*100,
    ps_sum = ps_1_prob + ps_2_prob,
    b365_sum = b365_1_prob + b365_2_prob,
    ps_1_prob = (ps_1_prob * 100)/ps_sum,
    ps_2_prob = (ps_2_prob * 100)/ps_sum,
    b365_1_prob = (b365_1_prob * 100)/b365_sum,
    b365_2_prob = (b365_2_prob * 100)/b365_sum) %>%
  filter(!is.na(ps_1), !is.na(b365_1), !is.na(rank_diff))

lr_mod <- logistic_reg() %>%
  set_engine("glm")

bet_fit <- lr_mod %>%
  fit(match_victor ~ b365_1_prob, data = bet_analysis)

# predict
bet_pred <- predict(bet_fit, new_data = bet_analysis %>% select(-match_victor), type = "prob")

# 7738 AIC

ps_fit <- lr_mod %>%
  fit(match_victor ~ ps_1_prob, data = bet_analysis)

ps_pred <- predict(ps_fit, new_data = bet_analysis %>% select(-match_victor), type = "prob")

# 7730 AIC

ranking_fit <- lr_mod %>%
  fit(match_victor ~ rank_diff, data = bet_analysis)

ranking_pred <- predict(ranking_fit, new_data = bet_analysis %>% select(-match_victor), type = "prob")

# 9411 AIC
```

```{=latex}
\begin{spacing}{1}
```

```{r}
#| label: tbl-bet-odds
#| tbl-cap: "Skill Measurements on Match Victor"

combined <- bind_rows(bet_fit %>% tidy(), ps_fit %>% tidy(), ranking_fit %>% tidy()) %>%
  slice(2,4,6) %>%
  select(estimate, std.error) %>%
  rename(
    "Standard Error" = std.error,
    "Log Odds" = estimate) %>%
  mutate(
    `Log Odds` = round(`Log Odds`, digits = 3),
    Predictors = c("Bet365", "Pinnacle Sports", "Ranking"),
    AIC = round(c(bet_fit$fit$aic, ps_fit$fit$aic, ranking_fit$fit$aic), digits = 0),
    `2.5%` = round(exp(`Log Odds` - 1.96 * `Standard Error`), digits = 3),
    `Odds Ratio` = round(exp(`Log Odds`), digits = 3),
    `97.5%` = round(exp(`Log Odds` + 1.96 * `Standard Error`), digits = 3)) %>%
  relocate(Predictors, .before = `Log Odds`) %>%
  relocate(AIC, .before = `Log Odds`) %>%
  select(-`Standard Error`, -`Log Odds`)

combined %>%
  gt()
  # flextable() %>%
  # align(align = "center", part = "all") %>% 
  # width(j = c(3:5), width = 1) %>%
  # width(j = 1, width = 1.3) %>%
  # colformat_double(j = c(3:5), digits = 3) %>%
  # colformat_double(j = 2, digits = 0)
```

```{=latex}
\end{spacing}
```

The **match victor** outcome variable is modeled in three logistic regressions, each containing one predictor. We then compare the Akaike Information Criterion (AIC) Score of each model to assess which of the three predictors fits the data best. We display the results of the three models in @tbl-bet-odds. The model using Pinnacle Sports' betting odds has the lowest AIC, so we will use it for our analysis. Henceforth, the betting odds of the match will refer to Pinnacle Sports' betting odds. The odds ratios interpretations are helpful for understanding the predictive power of the betting odds. A 1 percent point increase in Bet365's betting odds suggests a 5.7% increase in the odds of match victory. Conversely, a 1 percent point increase in Pinnacle Sport's betting odds suggests a 5.5% increase in the odds of victory. The difference in players' ranking is the least predictive of victory, but a 1 position increase in ranking (i.e. a worse ranking) lowers the estimated odds of victory by 1.1%. From AIC scores, it is clear that the player rankings are a much worse predictor of the victor of the match.

@fig-implied-probability displays the distribution of Pinnacle Sports' implied win probability values for player 1 across all matches. The curve appears to be generally uniform, with fewer observations in the extreme values. Interestingly, there are fewer matches with both players entering with an even win probability. In most matches, the betting odds tend to strongly favor one player.

```{r}
#| label: fig-implied-probability
#| fig-cap: "Pinnacle Sports Implied Probability Density"
# density plot
bet_analysis %>%
  mutate(ps_1_prob = ps_1_prob/100) %>%
  ggplot() +
  geom_density(aes(x = ps_1_prob), color = "cadetblue4") +
  labs(x = "Implied Win Probablity", y = "") +
  scale_x_continuous(labels = scales::percent) +
  scale_y_continuous(breaks = NULL) +
  theme(plot.title =element_blank())
```

\newpage

\noindent{\textit{Catalytic and Reducing Covariates}}

The catalytic covariates are potential catalysts of momentum. We hypothesize that these influential and memorable moments in a match provide a boost to players. These variables are events that have important characteristics or memorable results. In contrast, reducing covariates can include breaks in play that may disrupt natural flows of momentum. We define and describe several of these covariates below.

\textit{Break Converted.} Converting a break point is one of the keys to winning a match (Klaasen & Magnus, 2001). It has been found to cause positive momentum for the breaking player (Meier et al., 2020). The average match has 17 break chances and 7.1 converted break points.

```{r}
#| label: fig-breaks
#| fig-cap: "Breaks per Match Distribution"

gs %>% group_by(match_id) %>%
  summarise(
    break_converted = sum(p1_break_pt_won + p2_break_pt_won),
    break_chances = sum(p1_break_pt + p2_break_pt)) %>%
  pivot_longer(cols = c(break_converted,
                        break_chances), names_to = "type", values_to = "value") %>%
  ggplot() +
  geom_density(aes(x = value, color = type)) +
  scale_color_discrete(name = "", breaks = c("break_converted",
                                             "break_chances"), labels = c("Converted", "Chances")) +
  coord_cartesian(xlim = c(0,40)) +
  labs(title = "", x = "Breaks", y = "") +
  scale_y_continuous(breaks = NULL) +
  theme(plot.title=element_blank())
```

\textit{Break Saved.} Each time a player misses an opportunity to convert a break point, his or her opponent successfully saves a break point. While saving a break point does not lead to a positional or strategic advantage, we hypothesize that it could cause a recurring psychological advantage. Servers save break points about 58.19% of the time. This is notably less than their overall win rate on serve (61.14%).

\textit{Tiebreak Victory.} If two players are tied after twelve games of play in a set, they will enter into a tiebreak. Like break chances, tiebreaks have an asymmetric impact on the outcome of a tennis match. Winning a tiebreak can award a significant momentum effect on the rest of a match (Page & Coates, 2017). Tiebreaks are relatively uncommon; only 14.11% of sets end in a tiebreak. The average length of a tiebreak is 11.85 points.

\textit{Point Outcomes.} At the simplest level, a point always ends with a victor and a loser. However, the path of each point can differ greatly, and the covariates **ace**, **winner**, **double fault**, and **unforced error** help to capture several basic point outcomes. An ace is a serve left untouched by the returner. We hypothesize that this dominating shot may spark momentum. Similarly, a winner is a rally shot left untouched by the opponent. Many different types of points end with a winner, but they are often powerful and emotional shots. An ace is a type of winner. Conversely, a server double faults when they miss their serve twice in one point. This weak result is often frustrating for players. An unforced error is rally shot that a player misses by their own mistake and not by the skill of their opponent. A double fault is a type of unforced error. All four of these covariates are indicators variables for both player 1 and player 2. The designation of player 1 and player 2 are assigned randomly.

\textit{Point Length.} Not all tennis points are equal. Some last a few shots and players exert very little energy, while others are more grueling rallies that cost players significant amounts of energy. We hypothesize that as players exert more mental and physical energy during a single point, the point becomes more impactful.

One method to measure the length of the point is by the number of shots in a point. The covariate **rally length** adds up the total number of shots in a single point. In general, serves and made shots qualify but errors do not. A double fault (server misses serve) is a 0 shot rally and an unreturned serve qualifies as a 1 shot rally. A point with a serve, three completed shots, and an error has a rally length of 5 shots. The average rally length is 3.53 shots, but 67% of rallies are three shots or fewer.

The two players' distance run during a point is a second measure of the mental and physical energy exerted on a given point. **Distance run** is measured in meters and is generally correlated with **rally count**. In @fig-accuracy, we display the relationship between the total distance run by rally count. The scatterplot shows that there are some accuracy issues with both variables. If **rally count** is 0, then the distance run should also be close to 0. It is unlikely for the distance run to be close to 0 if the rally count is large. Perhaps most concerning is the cluster of points with rally lengths of 3-5 and distance runs over 100. The majority of these observations came from the US Open in 2021 and Wimbledon in 2021 and 2023.

```{r}
#| label: fig-accuracy
#| fig-cap: "Point Length Accuracy"
# US Open year 2021, Wimbledon 2023, 2021
gs %>%
  filter(!is.na(rally_count), !is.na(p1_distance_run), !is.na(p2_distance_run)) %>%
  mutate(
    total_distance_run = p1_distance_run + p2_distance_run) %>%
  ggplot() +
  geom_jitter(aes(x = rally_count, y = total_distance_run), size = 1, color = "darkgreen", alpha = .25) +
  scale_x_continuous(breaks = c(0,10,20,30,40, 50)) +
  labs(x = "Rally Length", y = "Distance Run") +
  theme(plot.title=element_blank())
```

For this reason, we choose to create the indicator variable **long point** as a combination of the two measurements of a point's length. Long points are defined as points where the total distance run between the two players exceeds 60 meters (12.2% of points) or the rally length of the point exceeds 6 shots (14.4% of points). A continuous covariate would likely perform better, but the insufficient data forces this transformation. By reducing the information in **rally length** and **distance run** to a single indicator variable, we assume that long points tend to have the same impact on a player regardless of the structure of the point. This assumption is supported because the distance run of the two players in a point is highly related. The average distance run by the server is 14.48 meters and the average distance run by the returner is 16.07 meters. The distribution is displayed in @fig-distance-run.

```{r, warning = FALSE}
#| label: fig-distance-run
#| fig-cap: "Distance Run per Point Distribution"

gs %>%
  filter(!is.na(p1_distance_run), !is.na(p2_distance_run)) %>%
  ungroup() %>%
  transmute(
    Server = if_else(server == 1, p1_distance_run, p2_distance_run),
    Returner = if_else(server == 1, p2_distance_run, p1_distance_run)) %>%
  pivot_longer(cols = c(Server, Returner), names_to = "player", values_to = "distance") %>%
  ggplot() +
  geom_density(aes(x = distance, color = player)) +
  scale_x_continuous(limits = c(0, 75)) +
  scale_y_continuous(breaks = NULL) +
  scale_color_discrete(name = "", breaks = c("Server", "Returner")) +
  labs(y = "", title = "", x = "Distance (meters)") +
  theme(plot.title=element_blank())
```

\textit{Interruption.} In the standard structure of a tennis match, players are afforded regular breaks from play. The players rest for approximately 90 seconds after the third, fifth, seventh, ninth, and eleventh games of a set. Injury timeouts typically take place during these natural interruptions. Players are also given a rest of 120 seconds after the conclusion of each set. In some tournaments, after the conclusion of the second set, players may choose to leave the courts for the locker room during a longer 10 minute break. Outside of these breaks, the play is relatively continuous. Players are encouraged to begin a point within 25 seconds of the conclusion of the previous point. In recent years, tournaments have employed serve clocks to lessen stoppage of play. 

We are interested in interruptions in play, because there is empirical evidence that interruptions reduce the effects of catalysts of momentum (Meier et al., 2020). Interruptions are a natural part of play, so the number of interruptions in a match is highly correlated with the number of points in a match. Longer matches have more interruptions and shorter matches have fewer. On average, there are 12.54 interruptions per match.

\textit{Change of Ends.} Players also regularly switch sides of the court. They typically switch during interruptions, but they also switch after the conclusion of the first game of a set and every sixth point in a tiebreak. Players are permitted to drink and refresh, but are not allowed to sit down. Thus, these situations can serve as miniature interruptions.

We are interested in comparing the impact between players changing sides of the court and a full interruption. The two covariates are highly related and have bimodal distributions. This is directly related to the contrasting structure of men's and women's tennis. Women's matches tend to be shorter, so most women's matches are located in the first peak. Conversely, men's matches are longer and are typically contained within the second peak. On average, there are 16.48 change of ends per match.

```{r}
#| label: fig-interruptions-change
#| fig-cap: "Interruptions and Change of Ends Frequency"

gs %>% group_by(match_id) %>%
  summarise(
    interruption = sum(interruption),
    change_ends = sum(change_ends)) %>%
  ungroup() %>%
  pivot_longer(cols = c(interruption, change_ends), names_to = "type", values_to = "freq") %>%
  ggplot() +
  geom_density(aes(x = freq, color = type)) +
  labs(title = "", x = "Frequency", y = "") +
  scale_y_continuous(breaks = NULL) +
  scale_color_discrete(name = "", labels = c("Change Ends", "Interruptions")) +
  theme(plot.title=element_blank())
```

\newpage

\begin{spacing}{1}
\vspace*{.1mm}
\begin{center}
\setlength{\parskip}{12pt}

CHAPTER FOUR

METHODOLOGY

\end{center}
\end{spacing}
\setlength{\parskip}{12pt}

In the methodology, we describe and justify the processes for visualizing, defining, and measuring momentum.

\setlength{\parskip}{12pt}
\begin{spacing}{1}
\begin{center}

\textit{Visualizing a Match}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

Our first step is to create a reproducible method for visualizing and analyzing an entire match. Tennis's hierarchical scoring structure makes it difficult to analyze the ebbs and flows of a match in its natural format. Extracting a match from the confines of its' hierarchical structure provides insight and ease. It is important to note, however, that this extraction assumes that the situations surrounding each point are identical (Klaasen & Magnus, 2001). In reality, certain points are more valuable to players and potentially inspire more energy and effort.

One simple method is to total each players' points won over the course of an entire match. As the match progresses, each player will accumulate point victories. We can compare the difference in the two players' totals and observe each players' point win rate over time. We define each players' cumulative number of points won ($x_{it}$) at point *t* where *i* indexes player 1 and player 2 of the match, $\tau$ indexes the point number of the match, and $z_{i\tau} \in \{0,1\}$ represents the binary outcome of point $\tau$ where 1 is a point victory.

```{=latex}
\begin{spacing}{1}
```

$$x_{it} = \sum^t_{\tau = 1}z_{i\tau}$$

```{=latex}
\end{spacing}
```

In @fig-cumulative-points below, we use the 2023 Wimbledon Gentlemen's singles final between Novak Djokovic and Carlos Alcaraz as an example. Each vertical gray line represents the start of a new set.

```{r function, include = FALSE}
grad_update <- function(F, order){
  n <- length(F)
  x <- seq(1, n, length.out = n)
  g <- numeric(n)
  if(order == 1){
    g[1] <- NA
    if (n > 2)
      g[2:n] <- (F[2:n] - F[1:(n - 1)])/(x[2:n] - x[1:(n - 1)])
  }
  if(order == 2){
    g[1] <- NA
    g[2] <- (F[2] - F[1])/(x[2] - x[1])
    # g[n] <- (3*F[n] - 4*F[n - 1] + F[n-2])/(2*(x[n] - x[n - 1]))
    if (n > 3)
      g[3:n] <- (3*F[3:n] - 4*F[2:(n-1)] + F[1:(n-2)])/(2*(x[3:n] - x[2:(n - 1)]))
  }
  if(order == 3){
    g[1] <- NA
    g[2] <- g[2] <- (F[2] - F[1])/(x[2] - x[1])
    g[3] <- (3*F[3] - 4*F[2] + F[1])/(2*(x[3] - x[2]))
    if (n > 3)
      g[4:n] <- (F[4:n] - 3*F[3:(n - 1)] + 3*F[2:(n - 2)] - F[1:(n-3)])/((x[4:n] - x[3:(n - 1)]))
  }
  return(g)
}

cum_points <- function(df, match_code, type) {
  df <- df %>% filter(match_id == match_code) %>%
    mutate(
      diff = p1_points_won - p2_points_won)
  vlines <- df %>% filter(set_victor != 0) %>% dplyr::select(point_no) %>% 
    dplyr::slice(1:(n()-1)) %>% pull()
  
  service <- df %>%
    summarise(
      exp_server = sum(point_victor == server)/n() - sum(point_victor != server)/n()) %>% pull()
  
  p1 <- df$player1[1]
  p2 <- df$player2[1]
  tourney <- df$tournament[1]
  gender <- df$sex[1]
  
  match <- df %>%
    mutate(
      point_margin = diff,
      serve_adj = if_else(point_victor == 1, 1, -1) + if_else(server == 1, -service, service),
      adj_point_margin = cumsum(serve_adj)) %>%
    as_tsibble(index = point_no)
  
  ses <- match %>%
    model(
      model = ETS(adj_point_margin ~ error("A") + trend("N", alpha = .1) + season("N")))
  
  match_flip <- df %>%
    mutate(
      point_margin = diff,
      serve_adj = if_else(point_victor == 1, 1, -1) + if_else(server == 1, -service, service),
      adj_point_margin = cumsum(serve_adj)) %>%
    as_tsibble(index = point_no) %>%
    mutate(flip = n() - point_no + 1) %>%
    arrange(flip) %>%
    as_tsibble(index = flip)
  
  ses_flip <- match_flip %>%
    model(
      model = ETS(adj_point_margin ~ error("A") + trend("N", alpha = .1) + season("N")))
  
  if(type == "both"){
    p <- df %>% ggplot() +
      geom_line(aes(point_no, p1_points_won, color = 'p1')) +
      geom_line(aes(point_no, p2_points_won, color = 'p2')) +
      scale_color_manual(name = 'Player',
                         breaks = c('p1', 'p2'),
                         labels = c(p1, p2),
                         values = c('p1' = 'cadetblue4', 'p2' = 'indianred3')) +
      geom_vline(xintercept = vlines, color = "darkgrey") +
      labs(y = "Points Won", x = "Point Number", title = str_c(p1, " vs. ", p2)) +
      scale_color_discrete(name = "Player", labels = c(str_extract_part(p1, " ", before = FALSE),
                                                       str_extract_part(p2, " ", before = FALSE))) +
      theme(legend.position = c(.9, .2))
    print(p)
  }
  if(type == "difference"){
    p <- df %>% ggplot(aes(point_no, diff, color = "indianred3")) +
      geom_line() +
      geom_vline(xintercept = vlines, color = "darkgrey") +
      labs(y = "Point Margin", x = "Point Number", title = str_c(p1, " (+) vs. ", p2, " (-)")) +
      theme(legend.position = "none")
    print(p)
  }
  if(type == "color serve"){
    p <- df %>% mutate(
      server = factor(if_else(server == 1, p1, p2))) %>%
      ggplot(aes(point_no, diff)) +
      geom_point(aes(color = server), size = .4) +
      geom_vline(xintercept = vlines, color = "darkgrey") +
      labs(y = "Point Margin", x = "Point Number", title = str_c(p1, " (+) vs. ", p2, " (-)")) +
      scale_color_discrete(name = "Server",
                           labels = c(str_extract_part(p2, " ", before = FALSE),
                                      str_extract_part(p1, " ", before = FALSE))) +
      theme(legend.position = c(.28, .18))
    print(p)
  }
  if(type == "adjusted"){
    p <- match %>%
      ggplot(aes(point_no, adj_point_margin, color = "indianred3")) +
      geom_line() +
      geom_vline(xintercept = vlines, color = "darkgrey") +
      labs(y = "Adjusted Point Margin", x = "Point Number", title = str_c(p1, " (+) vs. ", p2, " (-)")) +
      theme(legend.position = "none")
    print(p)
  }
  if(type == "smoothed"){
    p_back <- components(ses) %>%
      left_join(fitted(ses), by = c(".model", "point_no")) %>%
      mutate(adj_point_margin = replace_na(adj_point_margin, 0)) %>%
      slice(-1) %>%
      ggplot() +
      geom_line(aes(point_no, adj_point_margin), color = "indianred3") +
      geom_line(aes(point_no, level), color = "cadetblue4") +
      geom_vline(xintercept = vlines, color = "darkgrey") +
      labs(x = "", y = "Point Margin", title = "Backward Smoothing") +
      theme(axis.title.x = element_blank())
    
    p_forward <- components(ses_flip) %>%
      left_join(fitted(ses_flip), by = c(".model", "flip")) %>%
      mutate(
        adj_point_margin = replace_na(adj_point_margin, 0),
        point_no = n() - flip) %>%
      slice(-1) %>%
      ggplot() +
      geom_line(aes(point_no, adj_point_margin), color = "indianred3") +
      geom_line(aes(point_no, level), color = "cadetblue4") +
      geom_vline(xintercept = vlines, color = "darkgrey") +
      labs(x = "Point Number", y = "Point Margin", title = "Forward Smoothing")
    
    print(p_back/p_forward)
  }
  if(type == "compare orders"){
    smoothed <- components(ses) %>% slice(-1) %>%
      dplyr::select(point_no, adj_point_margin, level) %>%
      # add_row(point_no = 0, point_margin = 0, level = 0) %>%
      arrange(point_no) %>%
      mutate(
        gradient_o1 = grad_update(level, order = 1),
        gradient_o2 = grad_update(level, order = 2),
        point_victor = match$point_victor) %>%
      relocate(point_victor, .before = adj_point_margin)
    
    p1 <- ggplot(smoothed) +
      geom_line(aes(point_no, gradient_o1), color = "forestgreen") +
      labs(x = "", y = "Backward Momentum", title = "1st Order Approximation") +
      geom_vline(xintercept = vlines, color = "darkgrey") +
      geom_hline(yintercept = 0) +
      scale_y_continuous(breaks = c(-.6, -.3, 0, .3, .6), limits = c(-.65, .65)) +
      theme(axis.title.x = element_blank())
    # scale_color_manual(
    #   values = c(gradient_o1 = "forestgreen", gradient_o2 = "limegreen"),
    #   breaks = c("First Order", "Second Order"),
    #   labels = c(gradient_o1 = "First Order", gradient_o2 = "Second Order"),
    #   name = "")
    
    p2 <- ggplot(smoothed) +
      geom_line(aes(point_no, gradient_o2), color = "limegreen") +
      labs(x = "Point Number", y = "Backward Momentum", title = "2nd Order Approximation") +
      geom_vline(xintercept = vlines, color = "darkgrey") +
      geom_hline(yintercept = 0) +
      scale_y_continuous(breaks = c(-.6, -.3, 0, .3, .6), limits = c(-.65, .65))
    # scale_color_manual(
    #   values = c(gradient_o1 = "forestgreen", gradient_o2 = "limegreen"),
    #   breaks = c("First Order", "Second Order"),
    #   labels = c(gradient_o1 = "First Order", gradient_o2 = "Second Order"),
    #   name = "")
    
    print(p1/p2)
  }
  if(type == "full viz"){
    smoothed <- components(ses) %>% slice(-1) %>%
      dplyr::select(point_no, adj_point_margin, level) %>%
      # add_row(point_no = 0, point_margin = 0, level = 0) %>%
      arrange(point_no) %>%
      mutate(
        gradient_b1 = grad_update(level, order = 1),
        point_victor = match$point_victor) %>%
      relocate(point_victor, .before = adj_point_margin)

    smoothed_flip <- components(ses_flip) %>%
      slice(-1) %>%
      select(flip, adj_point_margin, level) %>%
      # add_row(point_no = 0, adj_point_margin = 0, level = 0) %>%
      arrange(flip) %>%
      mutate(
        gradient_f1 = -grad_update(level, order = 1)) %>%
      as_tibble() %>%
      mutate(
        point_no = n() - flip + 1) %>%
      arrange(point_no) %>%
      select(-flip, -adj_point_margin)

    total <- smoothed %>% left_join(smoothed_flip, join_by(point_no))

    p_back <- ggplot(total) +
      geom_line(aes(point_no, gradient_b1), color = "forestgreen") +
      labs(x = "", y = "", title = "Backward Momentum") +
      geom_vline(xintercept = vlines, color = "darkgrey") +
      geom_hline(yintercept = 0) +
      scale_y_continuous(breaks = c(-.6, -.3, 0, .3, .6)) +
      theme(axis.title = element_blank())
    
    p_future <- ggplot(total) +
      geom_line(aes(point_no, gradient_f1), color = "limegreen") +
      labs(x = "", y = "", title = "Future Momentum") +
      geom_vline(xintercept = vlines, color = "darkgrey") +
      geom_hline(yintercept = 0) +
      scale_y_continuous(breaks = c(-.6, -.3, 0, .3, .6)) +
      theme(axis.title = element_blank())
    
    p_adj_margin <- ggplot(total) +
      geom_line(aes(point_no, adj_point_margin), color = "indianred3") +
      labs(x = "", y = "", title = "Adjusted Point Margin") +
      geom_vline(xintercept = vlines, color = "darkgrey") +
      theme(axis.title = element_blank())
    
    print(p_back/p_adj_margin/p_future)
  }
}
```

```{r}
#| label: fig-cumulative-points
#| fig-cap: "Cumulative Points Won"

match_id <- "2023-wimbledon-1701"
cum_points(gs, match_id, "both")
```

This visualization is helpful, because it quickly displays the general trends of the match. However, small changes in momentum are difficult to identify and nuanced discoveries are lost. Instead, we choose to visualize matches by plotting the difference in the two players' total points won or the *point margin* or $m_{t}$ over time.

```{=latex}
\begin{spacing}{1}
```

$$m_{t} = x_{1t} - x_{2t}$$

```{=latex}
\end{spacing}
```

We can perform this adjustment without losing any information, because the two curves in @fig-cumulative-points are exactly correlated. That is, Djokovic and Alcaraz play a constant sum game $(z_{1\tau} + z_{2\tau} = 1)$. For this reason, the point margin visualization retains and emphasizes both the distance between the two players' scores and the overall trend of the match. In @fig-point-margin, the point margin is positive if Djokovic has won more points that Alcaraz, and the point margin is negative if Alcaraz has won more than Djokovic.

```{r}
#| label: fig-point-margin
#| fig-cap: "Point Margin"
cum_points(gs, match_id, "difference")
```

The set delineations are helpful for analysis. For example, this visualization demonstrates that Djokovic dominated the first set and the end of the fourth set. Alcaraz, on the other hand, had an advantage during the third set and the early portion of the fifth set.

The cyclical oscillations in the point margin curve in the second set signal the importance of accounting for structural variables. At first, these appear be a series of brief and alternating swings in momentum. Further analysis demonstrates that the point margin tends to increase (in Djokovic's favor) when Djokovic serves and decrease when Alcaraz serves. In @fig-colored-point-margin, we display the same point margin curve overlayed with the server of each point. Notice that sequence of points served by Djokovic tend to be associated with an overall increase in the point margin. This is most obvious in the middle of the second set. Without accounting for the server, it would be easy to conclude that Djokovic and Alcaraz briefly exchanged momentum several times in the second set. Instead, the players simply traded the structural advantage of serving.

```{r}
#| label: fig-colored-point-margin
#| fig-cap: "Point Margin (Server Emphasized)"
cum_points(gs, match_id, "color serve")
```

\newpage

\begin{spacing}{1}
\begin{center}
\setlength{\parskip}{12pt}

\textit{Defining Momentum}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

We define a player's momentum as the magnitude and direction of his or her performance at any instant in time. We measure this performance through the player's point win rate. Players compete directly, so every victory for a player is a corresponding defeat for his or her opponent. Thus, the momentum of two competing players is always equal and opposite. In colloquial settings, momentum is often portrayed as a binary outcome. A player either has "the momentum" or does not. We, however, choose to assess momentum as a continuous measurement of a player's trajectory in a match.

We propose estimating the players' momentum at any given point with the derivative of the point margin. The derivative of the point margin curve measures the instantaneous rate of change of the players' accumulation of points in the match. A player winning more points will always have a positive slope. Conversely, the slope of a player losing a majority of points will always be negative. In essence, this derivative captures the general trend of a match and extrapolates it from tennis' scoring system.

In practice, we utilize two different methods for estimating the momentum at a given point. The first, *backward momentum*, captures the trend of the match entering into a point. This estimates the total psychological impact of past results, giving greater weight to more recent points. We will use this measurement to assess the existence of momentum. The second method is *future momentum*, which estimates the future trend of the match after a point. This value gives more weight to points in the near future. We will use this measurement to identify features that impact of momentum.

\begin{spacing}{1}
\begin{center}
\setlength{\parskip}{12pt}

\textit{Server Adjustment}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

As seen in @fig-colored-point-margin, the server plays a strong role in the slope of the point margin curve. If a player were to serve a sequence of consecutive points, we would expect his or her point margin to increase. This, however, is not momentum, it is a temporary deviation in the match's structure that favors one player. We term this effect the match's *serve impact* $(\beta)$. Simply put, this effect is the difference between the server's point win rate and returner's point win rate for the duration of the match. We estimate the serve impact with $\hat{\beta}$ and compute where *n* is the total number of points in the match, $s_{i\tau} \in \{0,1\}$ indicates if player *i* is serving.

```{=latex}
\begin{spacing}{1}
```

$$\hat{\beta} = \displaystyle \frac{2}{n}\sum^2_{i=1}\sum^n_{\tau = 1}[z_{i\tau}s_{i\tau}] - 1$$

```{=latex}
\end{spacing}
```

We adjust for the serve impact in each match with the *adjusted point margin* $(y_{t})$. This is computed by subtracting the impact of both players' serve for the duration of the match from each point in the point margin curve.

```{=latex}
\begin{spacing}{1}
```

$$y_{t} = \sum^t_{\tau = 1}z_{1\tau}[(1-2s_{1\tau})\hat{\beta} + 1] - z_{2\tau}[(1-2s_{2\tau})\hat{\beta} + 1]$$

```{=latex}
\end{spacing}
```

In essence, this adjusted point margin gives more value for winning a point as a returner, because it less likely. It accounts for the natural advantage that the server possesses and extracts true momentum swings from structural conditions. This server adjustment is similar to a seasonal adjustment of a time series curve (Hyndman & Athanasopoulos, 2021). However, while the serve holds many similarities with a traditional seasonal component, it occurs at irregular intervals and is entirely binary.

In this adjustment, we assume that the serve impact is additive. By additive, we assume the serve impact is not significantly impacted by the size of the point margin. In other words, the effect of serving on the point margin does not naturally change as the point margin increases or decreases. In general, this holds true. However, for extreme values of point margin, the serve impact does tend to decrease (see @fig-serve-impact-pm). We also assume that the serve impact holds constant over the course of a match. This appears to be true (see @fig-serve-impact-match).

If the outcomes of consecutive points are unrelated, then we would expect the adjusted point margin curves of each tennis match to follow a random walk with drift. Conversely, if past results impact future results, then the curve will deviate from a random walk with drift.

@fig-adj-point-margin displays the adjusted point margin for the 2023 Wimbledon final. The serve impact for this match is .2216. The server won 61.1% of points and returner 38.9%. This adjusted curve displays the match's trend, isolated from the serve component. Notice that the oscillations in the second set are still present but dampened considerably.

```{r}
#| label: fig-adj-point-margin
#| fig-cap: "Adjusted Point Margin"

cum_points(gs, match_id, "adjusted")
```

\begin{spacing}{1}
\begin{center}
\setlength{\parskip}{12pt}

\textit{Exponential Smoothing}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

In practice, the differentiation of the point margin curve is difficult to estimate. The point number and point margin are discrete integers with an interval of 1. Even with the serve adjustment, the adjusted point margin is discrete, separated by intervals of $1 - \hat{\beta}$ or $1 + \hat{\beta}$. Thus, the pure differentiation at any given point is one of four values. We need a method to smooth the adjusted point margin curve, so the derivative encompasses the value of multiple points.

Most smoothing functions incorporate several observations before and after a given point *t* to appropriately smooth the curve at that point *t*. However, if we differentiate at point *t* and use it to estimate, say, point *t+1*, then our results will be biased. We need an entirely backward (or forward) smoothing method.

We use simple exponential smoothing (Hyndman & Athanasopoulos, 2021; Hyndman, 2023) to produce a smoothed adjusted point margin curve. We use a low smoothing parameter of $\alpha = .1$, so that the smoothed curve accounts for the broad trends of the match. Our goal is not primarily to fit the point margin curve, but rather to give the derivative meaningful values. For this reason, the level of the smoothed curve will often lag behind the actual values (see @fig-smoothed-curve). The slope, however, adjusts with the slope of the original curve.

The two methods for estimating momentum necessitate two methods for smoothing the curve. Backward momentum uses the traditional simple exponential smoothing. For our purposes, we call this backward smoothing ($\hat{y}_{bt}$).

```{=latex}
\begin{spacing}{1}
```

$$\hat{y}_{bt} = \alpha y_{t-1} + \alpha^2 y_{t-2} + \alpha^3 y_{t-3} + ...$$

```{=latex}
\end{spacing}
```

For future momentum, we flip the orientation of simple exponential smoothing and smooth from the right side. In this forward smoothing, the levels are estimated from the last point first. We use the same smoothing parameter of $\alpha = 0.1$. The equation for the forward smoothing is shown below.

```{=latex}
\begin{spacing}{1}
```

$$\hat{y}_{ft} = \alpha y_{t+1} + \alpha^2 y_{t+2} + \alpha^3 y_{t+3} + ...$$

```{=latex}
\end{spacing}
```

@fig-smoothed-curve displays the backward and forward smoothing. Notice that the backward smoothing lags behind actual values and the forward smoothing anticipates future values.

```{r, fig.height= 5}
#| label: fig-smoothed-curve
#| fig-cap: "Smoothing of Adjusted Point Margin"
cum_points(gs, match_id, "smoothed")
```

\newpage

\begin{spacing}{1}
\begin{center}
\setlength{\parskip}{12pt}

\textit{Differentiation}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

We differentiate the smoothed adjusted point margin curves to estimate the momentum at each point in the match. There are three general methods for approximating the instantaneous derivative of a curve: backward, forward, and complete differentiation. Complete differentiation provides the best estimate of the derivative, but the method utilizes future values to estimate the current derivative. For example, using first order complete differentiation, the derivative at point *t* is computed as

```{=latex}
\begin{spacing}{1}
```

$$\hat{y}^{'}_{t} = \frac{\hat{y}_{t+1} - \hat{y}_{t-1}}{2}$$

```{=latex}
\end{spacing}
```

Once again, this would introduce bias if $\hat{y}^{'}_{t}$ is later used to estimate $y_{t+1}$. Instead, we backward differentiate the backward smoothed curve, and forward differentiate the forward smooth curve to maintain our model's integrity. Thus, each derivative of the backward smoothed curve is estimated only with observations before point *t*. In the same way, each derivative of the forward smoothed curve is estimated only with points after point *t*.

We use a simple numerical differentiation for both estimates, because this is the only accessible backward and forward differentiation method. Methods like b-spline are preferred, but their implementation is solely for complete differentiation. The simple numerical differentiation is tantamount to drawing a secant line from point *t-1* to *t*, and using the slope of the secant line to estimate the slope at point *t*.

We compare first order and second order differentiation methods. Both methods are derived from Taylor Series Expansions. The first order backward difference approximation is given by $\hat{y}^{'}_{bt} = \hat{y}_{bt} - \hat{y}_{b(t-1)}$, and the second order backward difference approximation is given by $\hat{y}^{'}_{bt} = 3\hat{y}_{bt} - 4\hat{y}_{b(t-1)} + 2\hat{y}_{b(t-2)}$.

While both methods are viable estimations of the derivative, we find the first order approximation to be less volatile (see @fig-compare-orders). The second order approximation is more reactive to slight changes in the adjusted point margin curve. The variance of the second order approximations is .0573, while the variance of the first order approximations is .0498.

Our understanding is that momentum tends to build slowly over the course of a multitude points, so an estimation of the momentum that is less reactive to solitary points is preferable. For this reason, we utilize the first order approximation. With that being said, the two methods for approximating the derivative are relatively indistinguishable.

In @fig-compare-orders, we display both approximations for the backward momentum at each point. In this case, positive values indicate backward momentum for Djokovic and negative values indicate backward momentum for Alcaraz. Notice that the approximations have nearly identical trends and similar shapes. The second order approximation, however, tends to have steeper spikes, and it reacts more to short runs.

```{r, fig.height= 5}
#| label: fig-compare-orders
#| fig-cap: "First Order vs Second Order Approximation"
cum_points(gs, match_id, "compare orders")
```

The future momentum is computed in a similar way, using first order approximations. The curve, however, holds the future trend of the match in each point, so it differs from the backward momentum. Again, the future momentum anticipates a change in the adjusted point margin curve, while the backward momentum reacts after the change. We display the backward momentum, adjusted point margin, and future momentum in @fig-full-visualizations.

```{r, fig.height = 7.5}
#| label: fig-full-visualizations
#| fig-cap: "Momentum Curves"
cum_points(gs, match_id, type = "full viz")
```

\begin{spacing}{1}
\begin{center}
\setlength{\parskip}{12pt}


\textit{Describing Momentum}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

Both backward and future momentum are continuous variables with means of 0 that range from -1 to 1. However, about 95% of the values of momentum in our data set range from -.47 to .47. Values of momentum near -1 or 1 are rare. Thus, a value of -.5 represents strong momentum for player 2, and .5 represents strong momentum for player 1. A value of 0 represents neutral momentum. We plot the distributions of the two variables in @fig-momentum-dist. As expected, the variables have nearly identical distributions.

```{r}
#| label: fig-momentum-dist
#| fig-cap: "Momentum Distributions"

gs %>% pivot_longer(
  cols = c(gradient_backward, gradient_forward),
  names_to = "type", values_to = "momentum") %>%
  ggplot() +
  geom_density(aes(x = momentum, color = type)) +
  scale_color_discrete(name = "",
                       labels = c("gradient_backward" = "Backward",
                                  "gradient_forward" = "Future")) +
  labs(x = "Momentum", y = "") +
  theme(legend.position = c(.85, .77),
        plot.title=element_blank()) +
  scale_y_continuous(breaks = NULL)
```

It is important to note that backward momentum is measured as the momentum entering any given point. That is, the backward momentum at point *t* is the momentum before that point begins. It is a linear combination of the results at *t-1*, *t-2*, etc. Future momentum, however, is the opposite. Future momentum is measured as the momentum immediately after the point *t*. Thus, the future momentum is estimated by the results in *t+1*, *t+2*, etc.

Direct interpretations and applications of these momentum values can be difficult to assess. Momentum is the culmination of the results of many points, and representing it in a continuous variable from -1 to 1 can feel abstract. We provide context for these momentum values through concrete examples in @fig-interpretations. Here, we display the range of possible backward momentum values after various outcomes. This helps to bring tangible interpretations for our momentum values. For example, a player's backward momentum, conditional on winning ten points in a row, is an estimated .66. However, the estimate varies substantially; 95% of the values range from .471 to .845. This variation depends on the results of the earlier points in the match and the server of the ten points. Take another example. After a player wins four out of five points, we estimate his or her momentum to be .222, but we can reasonably expect it to fall between -.099 and .542. Again, this variation depends on the server of the five points, order of victory, and results of the preceding points. The full estimates and intervals lie in @tbl-interpret.

```{r, fig.height = 5}
#| label: fig-interpretations
#| fig-cap: "Interpreting Backward Momentum"
interpret <- gs %>%
  select(match_id, point_victor, gradient_backward, gradient_forward, point_no) %>%
  mutate(
    match_id = str_c(match_id, "_flip"),
    point_victor = if_else(point_victor == 1, 2, 1),
    gradient_backward = -gradient_backward,
    gradient_forward = -gradient_forward) %>%
  bind_rows(gs %>% select(point_victor, match_id, gradient_backward, gradient_forward, point_no)) %>%
  group_by(match_id) %>%
  mutate(
    point_victor = if_else(point_victor == 2, 0, point_victor),
    p1_points_won = cumsum(point_victor),
    fifteen_in_a_row = (p1_points_won - lag(p1_points_won, 15) == 15),
    sixteen_out_of_twenty = (p1_points_won - lag(p1_points_won, 20) == 16),
    twelve_out_of_fifteen = (p1_points_won - lag(p1_points_won, 15) == 12),
    ten_in_a_row = (p1_points_won - lag(p1_points_won, 10) == 10),
    eight_out_of_ten = (p1_points_won - lag(p1_points_won, 10) == 8),
    four_out_of_five = (p1_points_won - lag(p1_points_won, 5) == 4),
    five_in_a_row = (p1_points_won - lag(p1_points_won, 5) == 5),
    three_in_a_row = (p1_points_won - lag(p1_points_won, 3) == 3)) %>%
  ungroup() %>%
  select(gradient_backward, gradient_forward, contains("row"), contains("out_of"), point_no, match_id)

p1 <- bind_rows(
  interpret %>% filter(fifteen_in_a_row == TRUE) %>% select(gradient_backward, fifteen_in_a_row),
  interpret %>% filter(ten_in_a_row == TRUE) %>% select(gradient_backward, ten_in_a_row),
  interpret %>% filter(five_in_a_row == TRUE) %>% select(gradient_backward, five_in_a_row),
  interpret %>% filter(three_in_a_row == TRUE) %>% select(gradient_backward, three_in_a_row)) %>%
  mutate(type = case_when(
    fifteen_in_a_row == TRUE ~ "fifteen",
    ten_in_a_row == TRUE ~ "ten",
    five_in_a_row == TRUE ~ "five",
    three_in_a_row == TRUE ~ "three",
    .default = NA)) %>%
  select(gradient_backward, type) %>%
  ggplot() +
  geom_density(aes(x = gradient_backward, color = type)) +
  scale_color_manual(name = "Consecutive Points Won",
                       labels = c("fifteen" = "15",
                                  "ten" = "10",
                                  "five" = "5",
                                  "three" = "3"),
                     breaks = c("fifteen",
                                "ten",
                                "five",
                                "three"),
                       values = c("fifteen" = "chocolate2",
                                  "ten" = "indianred3",
                                  "five" = "cadetblue4",
                                  "three" = "forestgreen")) +
  labs(x = "", y = "") +
  theme(legend.position = c(.3, .6),
        plot.title=element_blank(),
        axis.title = element_blank()) +
  scale_y_continuous(breaks = NULL) +
  scale_x_continuous(limits = c(-.25, 1),
                     n.breaks = 6)

p2 <- bind_rows(
    interpret %>% filter(sixteen_out_of_twenty == TRUE) %>% select(gradient_backward, sixteen_out_of_twenty),
  interpret %>% filter(eight_out_of_ten == TRUE) %>% select(gradient_backward, eight_out_of_ten),
  interpret %>% filter(twelve_out_of_fifteen == TRUE) %>% select(gradient_backward, twelve_out_of_fifteen),
  interpret %>% filter(four_out_of_five == TRUE) %>% select(gradient_backward, four_out_of_five)) %>%
  mutate(type = case_when(
    sixteen_out_of_twenty == TRUE ~ "16/20",
    twelve_out_of_fifteen == TRUE ~ "12/15",
    eight_out_of_ten == TRUE ~ "8/10",
    four_out_of_five == TRUE ~ "4/5",
    .default = NA)) %>%
  select(gradient_backward, type) %>%
  ggplot() +
  geom_density(aes(x = gradient_backward, color = type)) +
  scale_color_manual(name = "Previous Win Rate",
                     breaks = c("16/20",
                                "12/15",
                                "8/10",
                                "4/5"),
                     values = c("16/20" = "chocolate2",
                                "12/15" = "indianred3",
                                "8/10" = "cadetblue4",
                                "4/5" = "forestgreen")) +
  labs(x = "Backward Momentum", y = "") +
  theme(legend.position = c(.25, .65),
        plot.title=element_blank(),
        axis.title.y = element_blank()) +
  scale_y_continuous(breaks = NULL) +
  scale_x_continuous(limits = c(-.25, 1),
                     n.breaks = 6)
p1/p2
```

In @fig-interpretations, we notice two important trends. First, we notice that even sustained dominance is unlikely to bring a player to a momentum of 1. A player, conditional on winning fifteen points in a row, has an estimated momentum of .809. The 95% interval ranges from .676 to .922.

Second, momentum is an estimation of long-term trends. Short runs impact the momentum, but not very heavily. Conditional on winning three points in a row, a player's momentum value, lies within the interval of -.119 to .622 in 95% of observations. A short run does not give us a precise estimate of momentum, because the long-term trend is more influential.

In fact, the mean momentum after a player wins twelve out of fifteen points (.482) is higher than the mean momentum of a player winning five points in a row (.419). This demonstrates that sustained long-term winning impacts momentum more than short bursts of dominance. Our measurement of momentum, therefore, is an estimation of the long-term trends in a match.

\newpage

\begin{spacing}{1}
\setlength{\parskip}{12pt}
\vspace*{.1mm}
\begin{center}

CHAPTER FIVE

RESULTS

\setlength{\parskip}{24pt}

\textit{Univariate Analysis of Set Momentum}

\end{center}
\end{spacing}
\setlength{\parskip}{0pt}

We begin with an initial descriptive analysis of the effect of momentum on a set-level. In a best-of-five set match, the two players can arrive at the pivotal fifth set in several ways. We hypothesize that the sequence of victories in the first four sets impacts the odds of winning the fifth set.

Our initial descriptive analysis supports this conclusion. Players that win the fourth set win the fifth set 57.6% of the time. Thus, per our interpretation, players who enter the fifth set with positive backward momentum tend to win the fifth set more often. Interestingly, this momentum compounds. Players who win the third and fourth set win the fifth set over 60% of the time. See @tbl-five-set-momentum for more details.

```{r}
sets <- gs %>%
  filter(sex == 1, last_pt_set == 1) %>%
  mutate(
    set1 = if_else(set_no == 1, point_victor, 0),
    set2 = if_else(set_no == 2, point_victor, 0),
    set3 = if_else(set_no == 3, point_victor, 0),
    set4 = if_else(set_no == 4, point_victor, 0),
    set5 = if_else(set_no == 5, point_victor, 0)) %>%
  group_by(match_id, match_victor) %>%
  summarise(
    set1 = sum(set1),
    set2 = sum(set2),
    set3 = sum(set3),
    set4 = sum(set4),
    set5 = sum(set5)) %>%
  mutate(
      across(match_victor:set5, ~case_when(
        match_victor == 2 & .x == 1 ~ 2,
        match_victor == 2 & .x == 2 ~ 1,
        .default = .x))) %>%
  select(-match_victor)
```

```{=latex}
\begin{spacing}{1}
```

```{r}
#| label: tbl-five-set-momentum
#| tbl-cap: "Momentum in Five Set Matches"
sample_size <- sets %>%
  group_by() %>%
  summarise(
    WWLL = sum(str_c(set1, set2, set3, set4) %in% c(1122,2211)),
    LLWW = sum(str_c(set1, set2, set3, set4) %in% c(1122,2211)),
    WLWL = sum(str_c(set1, set2, set3, set4) %in% c(1212,2121)),
    LWLW = sum(str_c(set1, set2, set3, set4) %in% c(1212,2121)),
    WLLW = sum(str_c(set1, set2, set3, set4) %in% c(1221,2112)),
    LWWL = sum(str_c(set1, set2, set3, set4) %in% c(1221,2112))) %>%
  t() %>% data.frame() %>% rownames_to_column() %>%
  rename("Sequence of Set Outcomes" = "rowname",
         "Sample Size" = ".")

# winning percentage if...
sets %>%
  group_by() %>%
  summarise(
    W = sum(set1 == 1)/sum(set1 %in% c(1,2)),
    L = sum(set1 == 2)/sum(set1 %in% c(1,2)),
    WW = sum(str_c(set1, set2) == 11)/sum(str_c(set1, set2) %in% c(22,11)),
    LL = sum(str_c(set1, set2) == 22)/sum(str_c(set1, set2) %in% c(22,11)),
    WL = sum(str_c(set1, set2) == 12)/sum(str_c(set1, set2) %in% c(12,21)),
    LW = sum(str_c(set1, set2) == 21)/sum(str_c(set1, set2) %in% c(12,21)),
    WWL = sum(str_c(set1, set2, set3) == 112)/sum(str_c(set1, set2, set3) %in% c(112,221)),
    LLW = sum(str_c(set1, set2, set3) == 221)/sum(str_c(set1, set2, set3) %in% c(112,221)),
    WLW = sum(str_c(set1, set2, set3) == 121)/sum(str_c(set1, set2, set3) %in% c(121,212)),
    LWL = sum(str_c(set1, set2, set3) == 212)/sum(str_c(set1, set2, set3) %in% c(121,212)),
    WLL = sum(str_c(set1, set2, set3) == 122)/sum(str_c(set1, set2, set3) %in% c(122,211)),
    LWW = sum(str_c(set1, set2, set3) == 211)/sum(str_c(set1, set2, set3) %in% c(122,211)),
    WWLL = sum(str_c(set1, set2, set3, set4) == 1122)/sum(str_c(set1, set2, set3, set4) %in% c(1122,2211)),
    LLWW = sum(str_c(set1, set2, set3, set4) == 2211)/sum(str_c(set1, set2, set3, set4) %in% c(1122,2211)),
    WLWL = sum(str_c(set1, set2, set3, set4) == 1212)/sum(str_c(set1, set2, set3, set4) %in% c(1212,2121)),
    LWLW = sum(str_c(set1, set2, set3, set4) == 2121)/sum(str_c(set1, set2, set3, set4) %in% c(1212,2121)),
    WLLW = sum(str_c(set1, set2, set3, set4) == 1221)/sum(str_c(set1, set2, set3, set4) %in% c(1221,2112)),
    LWWL = sum(str_c(set1, set2, set3, set4) == 2112)/sum(str_c(set1, set2, set3, set4) %in% c(1221,2112))) %>%
  select(WWLL, WLWL, LWWL, WLLW, LWLW, LLWW) %>%
  t() %>% data.frame() %>% rownames_to_column() %>%
  rename("Sequence of Set Outcomes" = "rowname",
         prop = ".") %>%
  left_join(sample_size, by = join_by(`Sequence of Set Outcomes`)) %>%
  mutate(
    `Fifth Set Win Percentage` = percent(prop, accuracy = .01),
    `Standard Error` = sqrt(prop * (1 - prop)/`Sample Size`),
    `Standard Error` = percent(`Standard Error`, accuracy = .01)) %>%
  select(-prop) %>%
  relocate(`Sample Size`, .after = `Standard Error`) %>%
  gt()
  # flextable() %>%
  # align(align = "center", part = "all") %>%
  # width(width = 1.2)
```

```{=latex}
\end{spacing}
```

@tbl-set-by-set demonstrates each sets' impact on the fifth set. Note that outcomes are conditional on the presence of a fifth set. For example, we find that players winning the fourth set, win the fifth set over 57% of the time. However, players that win the first set only win the fifth set around 44% of the time. Of course, this second scenario implies that the player entered the fifth set having lost two of the three previous sets.

Overall, this set-by-set descriptive analysis of momentum suggests that previous results impact players, but at a diminishing rate. Results in set four play a much larger role in the outcome of set five than results in set one.

```{=latex}
\begin{spacing}{1}
```

```{r}
#| label: tbl-set-by-set
#| tbl-cap: "Effect on Fifth Set"
sets %>%
  group_by() %>%
  summarise(
    "Win 4th set" = sum(set5 == 1&set4 == 1)/sum(set5 == 1),
    "Win 3rd set" = sum(set5 == 1&set3 == 1)/sum(set5 == 1),
    "Win 2nd set" = sum(set5 == 1&set2 == 1)/sum(set5 == 1),
    "Win 1st set" = sum(set5 == 1&set1 == 1)/sum(set5 == 1)) %>%
  t() %>% data.frame() %>% rownames_to_column() %>%
  rename("Result" = "rowname",
         "prop" = ".") %>%
  mutate(
    `Sample Size` = sum(sets$set5 == 1),
    `Fifth Set Win Percentage` = percent(prop, accuracy = .01),
    `Standard Error` = sqrt(prop * (1 - prop)/`Sample Size`),
    `Standard Error` = percent(`Standard Error`, accuracy = .01)) %>%
  select(-prop) %>%
  relocate(`Sample Size`, .after = `Standard Error`) %>%
  gt()
  # flextable() %>%
  # align(align = "center", part = "all") %>%
  # width(width = 1.2)

# most popular paths...
# sets %>% mutate(path = str_c(set1, set2, set3, set4, set5)) %>%
#   distinct(path, .keep_all = TRUE) %>%
#   group_by(path) %>%
#   summarise(Count = n()) %>%
#   arrange(desc(Count))
```

```{=latex}
\end{spacing}
```

\begin{spacing}{1}
\begin{center}
\setlength{\parskip}{3pt}

\textit{Does Momentum Exist?}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

Before we can identify the forces that impact momentum, we must first show that momentum exists. That is, we must demonstrate that the direction of a players' prior performance impacts his future performance. If there is no association between prior performance and future performance, then the outcomes of individual points are independent and identically distributed. Each players' odds of winning a point are constant throughout an entire match. Thus, we would expect the adjusted point margin curves to resemble random walks drifting in the direction of the difference in player skill.

Broadly, we evaluate the presence of momentum in a tennis match by detecting correlation between past performance and future performance after conditioning on relevant structural factors. We measure a players' performance up to a given point as the backward differentiation of the smoothed adjusted point margin curve at that point (see Methodology). We term this backward momentum. We model the effect of backward momentum on the odds of winning the next point. If backward momentum has a meaningful positive relationship with the winner of the next point, we can surmise that a player's success entering a point has an impact on their future success. This would provide evidence for the existence of momentum. Conversely, if the players' odds of winning various points are constant throughout the match and past and future performance are unrelated, then we would expect backward momentum to have no meaningful relationship with the point victor.

We assess this relationship using a logistic regression model (Hosmer, Lemeshow, & Sturdivant, 2013; Kuhn et al., 2020). While logistic regression may not necessarily provide the most accurate prediction for backward momentum, we are more interested in evaluating the estimates' coefficients than pure prediction power. We interact the sex of the players with backward momentum, because we are also interested in understanding male and female's different reactions to momentum.

The equation below displays the structure for each model. The dependent variable is the point victor $z_{mt} \in \{0,1\}$ at point *t* for each match *m* from player 1's perspective. The backward momentum $\hat{y}^{'}_{bmt}$ entering point *t* is the primary interest. To control for player skill imbalance, we control for the pre-match betting odds $b_m$. We also control for the sex of the players in the match $sex_{m}$, the tournament of which the match is played $t_{m}$, and the server of each point $s_{mt}$.

```{=latex}
\begin{spacing}{1}
```

$$logit(z_{1mt}) = \beta_0 + \beta_1b_m + \beta_2sex_{m}t_{m}s_{mt} + \beta_3\hat{y}^{'}_{bmt} + \epsilon_{mt}$$

```{=latex}
\end{spacing}
```

In the logistic regression model, we make several assumptions. We make the reasonable assumption that the relationship between backward momentum and the logit of the point victor is linear (see @fig-backward-linearity). Most importantly, the logistic model assumes that values of backward momentum are not autocorrelated. Of course, these values are autocorrelated by construction. However, we conduct a Durbin-Watson test (Durbin & Watson, 1971) and find that the autocorrelation is minimal and should not meaningfully impact our estimates. The results and explanation of the test are found in @tbl-exist-autocorrelation.

```{r modelling}
exist_momentum_men <- lr_mod %>%
  fit(point_victor ~ tournament:sex:server + lag1_gradient_backward:sex + lag1_gradient_backward + bet_odds*sex, data = cov)

cov2 <- cov %>% mutate(sex = factor(sex, levels = c("women", "men")))

exist_momentum_women <- lr_mod %>%
  fit(point_victor ~ tournament:sex:server + lag1_gradient_backward:sex + lag1_gradient_backward + bet_odds*sex, data = cov2)

exist_momentum_combined <- lr_mod %>%
  fit(point_victor ~ tournament:sex:server + lag1_gradient_backward + bet_odds, data = cov)

prep_table <- function(fit, name, multiplier){
  fit %>%
    tidy() %>%
    clean_names() %>%
    select(-statistic) %>%
    filter(!str_detect(term, "tournament")) %>%
    mutate(
      `2.5%` = exp(estimate * multiplier - 1.96*std_error*multiplier),
      odds_ratio = exp(estimate * multiplier),
      `97.5%` = exp(estimate * multiplier + 1.96*std_error*multiplier),
      across(where(is.numeric), ~round(.x, digits = 4))) %>%
    slice(1:3) %>%
    mutate(term = c("Intercept", "backward_momentum", "bet_odds")) %>%
    select(-estimate, -std_error, -p_value) %>%
    rename_with(~paste0(name, "_", .x), .cols = everything())
}

prep_log_table <- function(men_fit, women_fit, combined_fit, multiplier){
  em_men <- men_fit %>%
    prep_table("men", multiplier) %>%
    select(-contains("term"))
  
  em_women <- women_fit %>%
    prep_table("women", multiplier) %>%
    select(-contains("term"))
  
  combined_fit %>%
    prep_table("combined", multiplier) %>%
    bind_cols(em_men) %>%
    bind_cols(em_women) %>%
    rename("term" = "combined_term") %>%
    mutate(
      term = str_replace_all(term, "_", " "),
      term = str_to_title(term),
      term = recode(term,
                     "Bet Odds" = "Pre-Match Win Probability")) %>%
    rename_with(str_to_title)
}
```

The model produces the log odds estimates, which are difficult to interpret, so we transform the estimates into odds ratios (Hosmer, Lemeshow, & Sturdivant, 2013) in @tbl-exist-odds-ratios. We place the full log odds and the many structural interactions in @tbl-full-log-odds. We find that a 1 unit increase in the momentum entering a given point increases a player's odds of winning the point by an estimated 16.71%. With 95% certainty, we are confident the effect of a 1 unit increase in the momentum entering a point increases the players' odds of winning point by between 14.90% and 18.54%. This effect differs greatly for men and women. A 1 unit increase in momentum increases a male's odds of winning a point by 20.68%, and a 1 unit increase in momentum increases a female's odds of winning a point by 10.89%. All three of these results are both statistically significant and meaningful, indicating that a relationship exists. A 1 percentage point increase in the pre-match betting odds' implied win probability increases the player's odds of winning any given point by 0.58%. This is relatively consistent for male and female players.

```{=latex}
\begin{spacing}{1}
```

```{r model}
#| label: tbl-exist-odds-ratios
#| tbl-cap: "Does Momentum Exist - Odds Ratios and Confidence Intervals"

prep_log_table(exist_momentum_men, exist_momentum_women, exist_momentum_combined, 1) %>%
  gt()
  # flextable() %>%
  # add_header_row(
  #   values = c("", "Combined", "Men", "Women"),
  #   colwidths = c(1, 3, 3, 3), top = TRUE) %>%
  # set_header_labels(values = c("Term", "2.5%", "Odds Ratio", "97.5%", "2.5%", "Odds Ratio", "97.5%", "2.5%", "Odds Ratio", "97.5%")) %>%
  # align(align = "center", part = "all") %>%
  # width(j = 1, width = 1.1) %>%
  # width(j = c(2,4,5,7,8,10), width = .38) %>%
  # width(j = c(3,6,9), width = .85) %>%
  # colformat_double(j = c(3,6,9), digits = 3)
```

```{=latex}
\end{spacing}
```

Admittedly, a 1 unit increase in the momentum is a large increase; players enter 95% of points with a momentum between -.470 and .472 (see Methodology @fig-momentum-dist). Thus, a 1 unit increase in momentum is a comparison of these extremes. We posit that a half unit change in momentum is a much more reasonable shift in momentum. A half unit change in momentum represents a shift from a neutral situation (50th percentile) to a situation where one player has strong momentum (98.2 percentile). It also represents a shift from a slight momentum (15th percentile) in favor of one player to a slight momentum (85th percentile) in favor of his or her opponent.

We transform the odds ratios into a more interpretable value of a half unit change in momentum (Hosmer, Lemeshow, & Sturdivant, 2013). We display these new odds-ratios in @tbl-exist-odds-ratios-5. A half unit increase in the momentum entering a given point increases a player's odds of winning the point by an estimated 8.03%. With 95% certainty, we are confident the effect of a half unit increase in the momentum entering a point increases the players' odds of winning the point by between 7.19% and 8.87%. We use the term **momentum effect** to describe a player's change in odds of winning the point with a change in momentum. The results show that men experience more of a momentum effect than women. A half unit increase in the momentum entering a point increases a male's odds of winning a point by 9.85%, while a half unit increase in momentum entering a point increases a female's odds by 5.31%.

```{=latex}
\begin{spacing}{1}
```

```{r}
#| label: tbl-exist-odds-ratios-5
#| tbl-cap: "Does Momentum Exist - Odds Ratios and Confidence Intervals"

prep_log_table(exist_momentum_men, exist_momentum_women, exist_momentum_combined, .5) %>%
  filter(Term == "Backward Momentum") %>%
  pivot_longer(cols = ends_with("2.5%"), names_to = "Model", values_to = "2.5%") %>%
  pivot_longer(cols = ends_with("odds_ratio"), names_to = "model2", values_to = "Odds Ratio") %>%
  pivot_longer(cols = ends_with("97.5%"), names_to = "model3", values_to = "97.5%") %>%
  slice(1, 14, 27) %>%
  select(Model, `2.5%`, `Odds Ratio`, `97.5%`) %>%
  mutate(
    Model = str_remove(Model, "_2.5%")) %>%
  gt()
  # flextable() %>%
  # align(align = "center", part = "all") %>%
  # colformat_double(j = c(2:4), digits = 4)
```

```{=latex}
\end{spacing}
```

\noindent{\textit{Evaluating the model}}

Traditionally, logistic regression models are evaluated in their prediction accuracy. However, the overall lack of dominance on the point-level make individual tennis points difficult to predict. Across all matches in our data set, the winning player wins 54.7% of points (see @fig-victor-win-percentage). A model predicting that the eventual winner of the match will win each individual point will be incorrect more than 45% of the time! This makes predicting the winner of an individual tennis point incredibly difficult.

The odds of winning a point are highly influenced by the server of the point (see @fig-server-by-tournament). The server plays such a large role in the prediction process that our model predicts the server to win the point almost 98.6% of the time. Thus, the accuracy of our model (~61.5%) mostly reflects the overall likelihood of a server to win a point (~61.4%). However, our intention is primarily to assess the impact of the backward momentum on the point winner. While prediction is interesting, this model is not structured for prediction accuracy.

```{r include = FALSE}
# accuracy
full <- cov %>%
  select(point_victor, tournament, sex, server, bet_odds, lag1_gradient_backward) %>%
  augment(exist_momentum_men, .)
```

In @fig-probability-estimates, we display the estimated odds of a player winning the next point as the backward momentum varies. In these curves, we hold the betting odds' implied win probability constant at 50%. All values are for the server. We display eight curves, each reflecting unique conditions both between men's and women's tennis and within each tournament. The intercept for men's curves is higher, because the serve impact is larger for men. Within all settings, an increase in the backward momentum is associated with an increase in the estimated win probability. This increase is essentially linear within the bounds of backward momentum's possible values. Outside the bounds of backward momentum, the curve will follow the sigmoid curve, a characteristic of the logistic model. This visualization points to the disparity in the effect of momentum on men and women. The men's curves are steeper than women's, demonstrating that male players are more impacted by changes in backward momentum than female players.

The visualization also demonstrates that the value of serving changes drastically in different tournaments. For both men and women, Wimbledon provides the greatest serve impact, while the French Open provides the least. A male server's win probability in the Australian Open and US Open is almost identical, so only the US Open is shown. We explore the effect of backward momentum on win probability while varying betting odds and serving in women's matches at Wimbledon in @fig-betting-odds-server-momentum.

```{r, include = FALSE}
# estimates
e_co <- exist_momentum_men %>%
  tidy() %>%
  clean_names() %>%
  select(-statistic, -std_error, -p_value)

# Woman in US Open, serving, even betting odds
#women-server-us open
predicted_women <- tibble(
  backward_gradient = seq(-1, 1, by = .01),
  odds_wsu = exp(e_co$estimate[1] + e_co$estimate[4] + backward_gradient*(e_co$estimate[2] + e_co$estimate[5]) + 50*(e_co$estimate[3] + e_co$estimate[6]) + e_co$estimate[21]),
  pred_wsu = odds_wsu/(1+odds_wsu),
  odds_wsf = exp(e_co$estimate[1] + e_co$estimate[4] + backward_gradient*(e_co$estimate[2] + e_co$estimate[5]) + 50*(e_co$estimate[3] + e_co$estimate[6]) + e_co$estimate[20]),
  pred_wsf = odds_wsf/(1+odds_wsf),
  odds_wsa = exp(e_co$estimate[1] + e_co$estimate[4] + backward_gradient*(e_co$estimate[2] + e_co$estimate[5]) + 50*(e_co$estimate[3] + e_co$estimate[6]) + e_co$estimate[19]),
  pred_wsa = odds_wsa/(1+odds_wsa),
  odds_wsw = exp(e_co$estimate[1] + e_co$estimate[4] + backward_gradient*(e_co$estimate[2] + e_co$estimate[5]) + 50*(e_co$estimate[3] + e_co$estimate[6])),
  pred_wsw = odds_wsw/(1+odds_wsw))

predicted_men <- tibble(
  backward_gradient = seq(-1, 1, by = .01),
  odds_msu = exp(e_co$estimate[1] + backward_gradient*e_co$estimate[2] + 50*e_co$estimate[3] + e_co$estimate[17]),
  pred_msu = odds_msu/(1+odds_msu),
  odds_msf = exp(e_co$estimate[1] + backward_gradient*e_co$estimate[2] + 50*e_co$estimate[3] + e_co$estimate[16]),
  pred_msf = odds_msf/(1+odds_msf),
  odds_msa = exp(e_co$estimate[1] + backward_gradient*e_co$estimate[2] + 50*e_co$estimate[3] + e_co$estimate[15]),
  pred_msa = odds_msa/(1+odds_msa),
  odds_msw = exp(e_co$estimate[1] + backward_gradient*e_co$estimate[2] + 50*e_co$estimate[3]),
  pred_msw = odds_msw/(1+odds_msw))
```

```{r}
#| label: fig-probability-estimates
#| fig-cap: "Point Win Probability by Momentum"
predicted_men %>%
  left_join(predicted_women, by = join_by(backward_gradient)) %>%
  pivot_longer(cols = c(pred_msu, pred_msf, pred_msa, pred_msw, pred_wsu, pred_wsf, pred_wsa, pred_wsw), names_to = "type", values_to = "probability") %>%
  select(backward_gradient, type, probability) %>%
  mutate(
    Sex = if_else(str_detect(type, "_w"), "Women", "Men"),
    Tournament = case_when(
      str_detect(type, "sa") ~ "Australian Open",
      str_detect(type, "sw") ~ "Wimbledon",
      str_detect(type, "su") ~ "US Open",
      str_detect(type, "sf") ~ "French Open",
      .default = NA)) %>%
  ggplot() +
  geom_line(aes(x = backward_gradient, y = probability, color = Tournament, linetype = Sex)) +
  scale_color_manual(
    values = c(`Australian Open` = "cadetblue3", `French Open` = "indianred3", `US Open` = "navyblue", `Wimbledon` = "forestgreen"),
    breaks = c("Wimbledon", "US Open", "Australian Open", "French Open"),
    name = "") +
  scale_linetype_manual(
        values = c(Men = "solid", Women = "dashed"),
        name = "") +
  labs(x = "Backward Momentum", y = "", title = "") +
  scale_y_continuous(labels = scales::percent) +
  theme(plot.title=element_blank())
```

\noindent{\textit{Verification}}

One of the primary concerns of this model is that the asymmetry in player skill will disrupt results. We control for player skill with the pre-match betting odds of the match, but it is possible that player skill at the time of the match is a stochastic process that randomly deviates from the true player skill. The pre-match betting odds are simply a point estimate of the player's skill entering a match. If so, then the difference between the player's skill during the match and the estimated skill would be left unaccounted for by our controls. If this difference is large enough, it could correlate with both backward momentum and point victor for the duration of the match. This unknown confounding variable could give momentum the appearance of explaining the point victor even if there is no causal relationship.

If this concern is true and momentum does not exist, then the backward momentum is purely a function of the player's skill in the match and is unrelated with the time that points occur. The backward momentum entering point *t* should have the same relationship with the result of point *t* as point *t+50*. That is, the proximity of backward momentum and the point result should have no impact on the estimate.

To assess the validity of this concern, we estimate the coefficients of **backward momentum** regressed on the point victor. We compare the relationship between backward momentum and point *t* with backward momentum and point *t+1*, etc. We display the results of all three models (men, women, and combined) in @fig-future-backward-momentum. We see that as the time-distance between the point and backward momentum increases, the size of the relationship tends to decrease significantly for all three models. Backward momentum at point *t* is highly correlated with backward momentum at point *t+1*, so it is unsurprising that the estimates take some time to diminish in size. Moreover, we posit that momentum tends to be a slow-reacting force, so we would expect the momentum effect to linger or even compound for many points. However, it is clear that backward momentum is a much stronger predictor for the outcome of near points than far points for all three models. This demonstrates that the unknown confounder *player skill*, which remains constant throughout the entire match for both players (we suggest that traits of the player that vary throughout the match are encompassed in our definition of momentum) is not the primary actor on backward momentum. If so, the effect of backward momentum at point *t* on the outcome future points would remain constant for the entirety of the match.

```{r}
#| label: fig-future-backward-momentum
#| fig-cap: "Backward Momentum on Future Points"

robust %>%
  mutate(
    type = str_to_title(type),
    type = factor(type, levels = c("Men", "Combined", "Women")),
    lower_limit = estimate - std.error*1.96,
    upper_limit = estimate + std.error*1.96) %>%
  ggplot(aes(x = covariate, y = estimate)) +
  # geom_point(aes(color = type), size = .25) +
  geom_smooth(aes(color = type), span = .4, se = FALSE, method = "loess") +
  geom_pointrange(aes(ymin = lower_limit, ymax = upper_limit, color = type), size = .025, alpha = .5) +
  geom_hline(yintercept = 0) +
  labs(x = "Point", y = "Log Odds", title = "") +
  scale_x_continuous(limits = c(0, 80)) +
  scale_y_continuous(breaks = c(-.05, 0,.05, .1, .15, .2), limits = c(-.06, .225)) +
  scale_color_discrete(name = "") +
  theme(plot.title=element_blank())
```

Altogether, we see that the effects of backward momentum at point *t* diminish over time. We can conclude for all three models that the effect of backward momentum is not meaningfully confounded by the player skill at the time of the match. Our interpretations, therefore, are not meaningfully disrupted.

\noindent{\textit{Second Approach}}

For robustness, we take a second approach to verify that backward momentum impacts future results. Previously, we demonstrate that backward momentum tends to increase odds of winning the next point. Now, we are interested in backward momentum's impact on the future trend of the match. That is, what effect does backward momentum have on future momentum? The outcome variable **future momentum** measures the future trend of a match immediately after a point on a continuous scale from -1 to 1 (see Methodology), and the covariate **backward momentum** measures a player's performance up to a given point. Thus, we argue that if a players' momentum does not exist, then while controlling for structural variables, backward momentum should have no correlation with future momentum. If matches follow a random walk with drift, then past performance should have no association with future performance if the drift is controlled.

In this model, we use multi-linear regression to assess the effect of backward momentum $\hat{y}^{'}_{bmt}$ on future momentum $\hat{y}^{'}_{fmt}$. As before, we control for the pre-match betting odds $b_{m}$ of each match, the sex of the players $sex_m$, the tournament $t_{m}$, and server $s_{mt}$ of each point. Each variable is from player 1's perspective.

```{=latex}
\begin{spacing}{1}
```

$$\hat{y}^{'}_{fmt} = \beta_0 + \beta_1b_m + \beta_2sex_{m}t_{m}s_{mt} + \beta_3\hat{y}^{'}_{bmt} + \epsilon_{mt}$$

```{=latex}
\end{spacing}
```

In the model, we assume that the relationship between the covariates and the future momentum is linear. We assume that the residuals are normally distributed and homoscedastic, and we assume that the covariates are uncorrelated. We find all four of these assumptions are supported (see @fig-approach-assumptions).

We display the results of the model in @tbl-second-approach. As in the logistic model, we transform the backward momentum values, so that the estimates display the effect of a half-unit change in backward momentum. We find this half-unit change to be a more reasonable change in momentum. A half-unit increase in backward momentum amounts to a .0169 unit increase in future momentum. Again, we find stronger evidence for a momentum effect in men than women. For men, the half-unit increase is associated with a .0224 unit increase in future momentum, while women see a .0081 unit increase in future momentum. The pre-match win probability estimate is consistent throughout the models at about .0025. We place the estimates for the structural variables in @tbl-second-full-results.

```{=latex}
\begin{spacing}{1}
```

```{r}
lm_spec <- linear_reg() %>%
  set_mode("regression") %>%
  set_engine("lm")

momentum_relationship <- lm_spec %>%
  fit(gradient_forward ~ server:sex:tournament + bet_odds + gradient_backward, data = cov %>% mutate(gradient_backward = gradient_backward*2))

cov_men <- cov %>% filter(sex == "men")

momentum_relationship_men <- lm_spec %>%
  fit(gradient_forward ~ server:tournament + bet_odds + gradient_backward, data = cov_men %>% mutate(gradient_backward = gradient_backward*2))

cov_women <- cov %>% filter(sex == "women")

momentum_relationship_women <- lm_spec %>%
  fit(gradient_forward ~ server:tournament + bet_odds + gradient_backward, data = cov_women %>% mutate(gradient_backward = gradient_backward*2))

percentile_effect <- function(vector){
  result <- vector()
  for(i in 1:length(vector)){
    value <- mean(vector[i] > gs$gradient_forward, na.rm = TRUE) - mean(0 > gs$gradient_forward, na.rm = TRUE)
    result <- c(result, value)
  }
  result
}

prep_linear_table <- function(model_fit, name){
  model_fit %>% 
    pluck("fit") %>%
    tidy() %>%
    clean_names() %>%
    select(-statistic) %>%
    mutate(
      # `Percent Change` = percentile_effect(estimate),
      across(where(is.numeric), ~round(.x, digits = 4)),
      symbol = case_when(
        p_value < .001 ~ "***",
        p_value < .01 ~ "**",
        p_value < .05 ~ "*",
        .default = ""),
      estimate = str_c(as.character(format(estimate, scientific = FALSE)), symbol),
      std_error = str_c("(", format(std_error, scientific = FALSE), ")")) %>%
    pivot_longer(cols = c(estimate, std_error), names_to = "metric", values_to = name) %>%
    select(-symbol, -p_value) %>%
    # relocate(`Percent Change`, .after = last_col()) %>%
    filter(!str_detect(term, "2"), !str_detect(term, "sex"), !str_detect(term, "server"), !str_detect(term, "Intercept"), !str_detect(term, "victor0"))}
```

```{r}
#| label: tbl-second-approach
#| tbl-cap: "Backward and Future Momentum Relationship"

momentum_relationship %>%
  prep_linear_table("full") %>%
  left_join(momentum_relationship_men %>% prep_linear_table("men"), by = join_by(term, metric)) %>%
  left_join(momentum_relationship_women %>% prep_linear_table("women"), by = join_by(term, metric)) %>%
  mutate(
    term = dplyr::recode(term,
                  "bet_odds" = "Pre-Match Win Probability",
                  "gradient_backward" = "Backward Momentum")) %>%
  select(-metric) %>%
  rename_with(str_to_title) %>%
  gt()
  # flextable() %>%
  # align(align = "center", part = "all") %>%
  # merge_v(j = ~Term) %>%
  # set_header_labels(values = c("Term", "Combined", "Men", "Women")) %>%
  # width(j = 1, width = 1.2)
```

```{=latex}
\end{spacing}
```

\begin{spacing}{1}
\begin{center}
\setlength{\parskip}{3pt}

\textit{What Factors Impact Momentum?}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

Having found evidence for the existence of momentum, we progress to identifying the influences of momentum. We are interested in identifying the characteristics of a point that tend to increase or decrease the trajectory of the match from that point. We ask, do certain types of points or results typically increase or decrease momentum? We use a linear regression model to evaluate the effect of various match characteristics at a given point on the future momentum.

We posit that certain covariates have a short-term effect on a match's momentum, while the effect of other covariates is more long-lasting. For instance, the **point victor** covariate may have a strong impact on the future momentum of the next point, but it's effect likely wanes after a few more points cloud the memory of the player. The **set victor** covariate, however, is likely to still have a sizable impact on the match's momentum for a long period of time. For this reason, we divide our covariates into two similar models. The first model is on the point-level, and the second model is on the game-level.

One advantage of our data set is the quantity of observations. This allows us to evaluate the impact of rare interacting scenarios. However, this artificially diminishes the p-values of some of our estimators. Often, this leads to some covariates holding small p-values despite possessing a weak effect on the outcome variable. Known as the Large Samples and p-value problem, this is an increasingly prominent hurdle for researchers (Lin, Lucas, & Shmueli, 2013; Gomez-de-Mariscal et al., 2021).

To combat these potential problems, we reduce the size of our data set in a secondary model that only contains matches where players have close pre-match win probabilities. We specifically include all matches where the pre-match win probability for each player is at least 40%. This accomplishes two objectives. First, it reduces our data set dramatically (1.36 million to 250,000 observations). This will make the p-values more representative. Second, it eliminates matches that have a large skill discrepancy among the players. These matches are more likely to be one-sided, with one player holding the momentum for nearly the entire match. This (as well as the betting odds control), further reduces the potential for the unknown confounding variable *player skill* to disrupt the results. We display the coefficients of both the full and reduced models together in @tbl-point-level. In our analysis of the results, we intentionally emphasize the effect size of the coefficients instead of their significance (Lin, Lucas, & Shmueli, 2013).

\noindent{\textit{Point Level Model}}

The point-level model uses a multi-linear regression model (Kuhn & Johnson, 2013; Kuhn et al., 2020) to estimate the effect of several short-term covariates on the future momentum $\hat{y}^{'}_{fmt}$ after each point *t*. Several of the covariates apply for both players and are indexed by *i*. We assess the effect of winning a point $z_{mt}$, winning a long point $x_{1tm}$, converting $x_{2imt}$ or saving a break point $x_{3imt}$, and hitting a winner $x_{4imt}$, ace $x_{5imt}$, double fault $x_{6imt}$, or unforced error $x_{7imt}$ on the future momentum. We control for the server $s_{mt}$, pre-match betting odds $b_m$, and the sex of the players $sex_m$ and tournament $t_m$ of the match *m*. We run this model on male and female subsets of the data to analyze the different relationships that males and females have with momentum.

\begin{spacing}{1}

\begin{multline*}
\hat{y}^{'}_{fmt} = \beta_0 + \beta_1b_m + \beta_2sex_{m}t_{m}s_{mt} + \beta_3z_{mt} + \beta_4x_{1mt}z_{mt} + \beta_5x_{2imt}\\
+ \beta_6x_{3imt} + \beta_7x_{4imt} + \beta_8x_{5imt} + \beta_9x_{6imt} + \beta_10x_{7imt} + \epsilon_{mt}
\end{multline*}

\end{spacing}

Many of these covariates exist for both player 1 and player 2. For example, both player 1 and player 2 can hit an ace. However, the assignment of player 1 and player 2 is random, so the estimates of the covariates should be relatively equal (with some random noise) and opposite. For ease, we display only player 1's covariates. The conclusions we draw are the same for player 2, and these results are located in @tbl-point-full-results.

In this model and its' interpretations, we make several assumptions. We assume that the relationship between the covariates and the future momentum is linear. We assume that the residuals are normally distributed and homoscedastic. These assumptions are supported by figures located in @fig-point-assumptions.

We also assume that the covariates themselves are uncorrelated. By choice, some of the covariates of the model are correlated. For example, hitting a winner or ace is correlated with winning a point, because every time a player hits a winner or ace, they win the point. Moreover, we introduce multicollinearity intentionally with interaction terms. However, the only large correlation between covariates is between **winner**, **ace**, and the **point victor** (see @fig-point-correlation-matrix). We do not anticipate that these correlations adversely impact the estimates. Outside of **winner**, the Variance Inflation Factor (VIF) for each covariate is less than 2, and the estimates do not appear to be unstable. The extensive tables are located in @tbl-point-multicollinearity.

```{r include = FALSE}
# interesting and all good on the point level
cov_model <- lm_spec %>%
  fit(gradient_forward ~ server:sex:tournament + bet_odds + point_victor + 
        point_victor:long_point + break_converted + break_saved +
        p1_winner + p2_winner + p1_ace + p2_ace + p1_double_fault + p2_double_fault +
        p1_unf_err + p2_unf_err, data = cov)

cov_model_men <- lm_spec %>%
  fit(gradient_forward ~ server:tournament + bet_odds + point_victor + 
        point_victor:long_point + break_converted + break_saved +
        p1_winner + p2_winner + p1_ace + p2_ace + p1_double_fault + p2_double_fault +
        p1_unf_err + p2_unf_err, data = cov_men)

cov_model_women <- lm_spec %>%
  fit(gradient_forward ~ server:tournament + bet_odds + point_victor + 
        point_victor:long_point + break_converted + break_saved +
        p1_winner + p2_winner + p1_ace + p2_ace + p1_double_fault + p2_double_fault +
        p1_unf_err + p2_unf_err, data = cov_women)

cov_close <- cov %>% filter(between(bet_odds, 40, 60))

cov_model_close <- lm_spec %>%
  fit(gradient_forward ~ server:sex:tournament + bet_odds + point_victor + 
        point_victor:long_point + break_converted + break_saved +
        p1_winner + p2_winner + p1_ace + p2_ace + p1_double_fault + p2_double_fault +
        p1_unf_err + p2_unf_err, data = cov_close)

cov_close_men <- cov_men %>% filter(between(bet_odds, 40, 60))

cov_model_close_men <- lm_spec %>%
  fit(gradient_forward ~ server:tournament + bet_odds + point_victor + 
        point_victor:long_point + break_converted + break_saved +
        p1_winner + p2_winner + p1_ace + p2_ace + p1_double_fault + p2_double_fault +
        p1_unf_err + p2_unf_err, data = cov_close_men)

cov_close_women <- cov_women %>% filter(between(bet_odds, 40, 60))

cov_model_close_women <- lm_spec %>%
  fit(gradient_forward ~ server:tournament + bet_odds + point_victor + 
        point_victor:long_point + break_converted + break_saved +
        p1_winner + p2_winner + p1_ace + p2_ace + p1_double_fault + p2_double_fault +
        p1_unf_err + p2_unf_err, data = cov_close_women)

prep_linear_tables <- function(comb_full, comb_reduced, men_full, men_reduced, women_full, women_reduced){
  c1 <- prep_linear_table(comb_reduced, "Combined Reduced")
  c2 <- prep_linear_table(comb_full, "Combined Full") %>%
    left_join(c1, by = join_by(term, metric))
  m1 <- prep_linear_table(men_reduced, "Men Reduced")
  m2 <- prep_linear_table(men_full, "Men Full") %>%
    left_join(m1, by = join_by(term, metric))
  w1 <- prep_linear_table(women_reduced, "Women Reduced")
  w2 <- prep_linear_table(women_full, "Women Full") %>%
    left_join(w1, by = join_by(term, metric))

  left_join(c2, m2, by = join_by(term, metric)) %>%
    left_join(w2, by = join_by(term, metric)) %>%
    mutate(
      term = str_remove(term, "p1_"),
      term = str_remove_all(term, "1"),
      term = str_replace_all(term, "_", " "),
      term = str_replace_all(term, ":", " & "),
      term = str_to_title(term),
      term = dplyr::recode(term,
                     "Bet Odds" = "Pre-Match Win Probability",
                    "Unf Err" = "Unforced Error")) %>%
    select(-metric) %>%
    rename_with(str_to_title)
}
```

Interpreting the effect size of the estimates is a challenge. We compute the percentile change (from the mean) in future momentum with a 1 unit change in the covariate. For example, a 2% percentile change reflects a shift from the 50th to 52nd percentile with a 1 unit change in the covariate. An estimate of .015 yields a 2.55 percentile increase. Coefficients of .01 and .005 yield a 1.70 and 0.84 percentile increase, respectively. The standard errors of the estimates are in parenthesis, and the significance level is noted with asterisks on the estimates.

We find that converting a break tends to bring a large increase in future momentum. Players converting a break point tend to see a .0156 unit increase in their future momentum. This is particularly significant, given that a .0156 increase has an overall 2.6 percentile increase in future momentum. Converting a break point is significant among both male and female players (~.016). Interestingly, this effect increases for men in the reduced model (.0195) but decreases for women in the reduced model (.0118).

We also find strong evidence that saving a break point tends to decrease (-.0068) future momentum. This can be reinterpreted to demonstrate that a player close to breaking serve still tends to find a significant increase in future momentum. However, this increase is much smaller than the increase had the player converted the break point. As with before, the effect size is much larger for male players (.0094) than female players (.0032).

We find that winning a point tends to increase future momentum for male players. In both the full and reduced model, the point victor yields a strong association (.0034) with an increase in future momentum. This association increases for men (.0049), but decreases significantly for women (.0009). This casts some doubt on the association between winning a point and future momentum for women.

There is evidence that hitting an ace tends to increase future momentum (.0068). The effect size remains positive for both men (.0078) and women (.0042). The female and male estimates increase and decrease, respectively, in the reduced model, but it is possible that this change is due to the correlation between the **ace** and **winner** covariates explained below.

There is mild evidence that striking a winner impacts future momentum. The full model has a very weak estimate (.0002), but there is a much stronger association (.0033) in the reduced model. The winner estimate for men is negative and insignificant in the full model, but strong and positive in the reduced model. The winner coefficient for women is positive but mediocre within both models. All aces are winners, and we posit that the strong effect of an ace on momentum clouds the effect of a winner.

The model fails to find a large effect for double faults, unforced errors, and winning long points. Generally, the estimates of all four covariates hold the sign that we would expect in both the combined full and combined reduced model, but their effect sizes are small. Double faults tend to have a slight, insignificant negative effect on future momentum (-.0011). Unforced errors tend to have a slight negative effect (-.0004), but there are some surprising and irregular results in the smaller models. There is minimal evidence that long points diminish the overall effect of winning points (-.002). This effect size is greater for men (-.0028) and within the reduced model (-.0035). However, the sign of the estimate flips for player 2 (see @tbl-point-full-results). This suggests that the result may be too weak to draw conclusions.

In total, we find that converting a break point and striking an ace tend to increase future momentum, while saving a break point correlates with a decrease in future momentum. We have strong evidence that hitting a winner increases future momentum for men, and we have mild evidence that striking winners leads to an increase in future momentum. In general, we find a greater effect size for men than women.

```{=latex}
\begin{spacing}{1}
```

```{r}
#| label: tbl-point-level
#| tbl-cap: "What Impacts Momentum: Point Level"

prep_linear_tables(cov_model, cov_model_close, cov_model_men, cov_model_close_men, cov_model_women, cov_model_close_women) %>%
  gt()
  # flextable() %>%
  # align(align = "center", part = "all") %>%
  # merge_v(j = ~Term) %>%
  # add_header_row(
  #   values = c("", "Combined", "Men", "Women"),
  #   colwidths = c(1, 2, 2, 2), top = TRUE) %>%
  # set_header_labels(values = c("Term", "Full", "Reduced", "Full", "Reduced", "Full", "Reduced")) %>%
  # # merge_v(j = c(3,5,7,9,11,13)) %>%
  # width(j = 1, width = 1.3)
```

```{=latex}
\end{spacing}
```

\noindent{\textit{Game Level Model}}

The game-level model utilizes a second multi-linear regression model to estimate the effect of the long-term covariates on the future momentum $\hat{y}^{'}_{fmT}$ after the conclusion of each game *T*. We assess the effect of winning a game $x_{1mT}$, set $x_{2mT}$, or tiebreak $x_{3mT}$ on the future momentum. We also interact the effect of changing sides of the court $x_{4mT}$ and an interruption in play $x_{5mT}$ with winning a game. Again, we apply this model on a male and female subset to assess the nuanced effect that a player's sex has on momentum. We control for the server $s_{mT}$, pre-match betting odds $b_m$, the sex of the players $sex_m$, and tournament $t_m$ of the match *m*.

\begin{spacing}{1}

\begin{multline*}
\hat{y}^{'}_{fmt} = \beta_0 + \beta_1b_m + \beta_2sex_{m}t_{m}s_{mT} + \beta_3x_{1mT} + \beta_4x_{2mT}\\
+ \beta_5x_{3mT} + \beta_6x_{4mT}x_{1mT} + \beta_7x_{5mT}x_{1mT} + \epsilon_{mT}
\end{multline*}

\end{spacing}

As with the point level model, the values for player 1 and 2 are similar, so we display the covariates only from player 1's perspective. As in the point level model, we assume that the relationship between the long-term covariates and the future momentum is linear. We assume that the residuals are normally distributed and homoscedastic. We find that all three of these assumptions are supported (see @fig-game-assumptions).

Once again, our assumption that the covariates are uncorrelated is challenged. If **set victor** holds a value of 1, then so will **game victor**. Similarly, **tiebreak victor** and **set victor** have nested relationships. In addition, we intentionally introduce correlation by using interaction terms (such as interacting **interruption** with **game victor**). The largest correlations are between **interruption** and **change ends**, and between **game victor** and **server** (see @fig-game-correlation-matrix). The relationship between **interruption** and **change ends** is concerning, as removing one covariate does meaningfully impact the other covariate's estimate. In general, we are less certain about conclusions related with these covariates. However, as a whole, the VIF of each covariate is less than 5, and we do not anticipate that these correlations adversely impact the estimates. The supporting figures and tables are located in the Appendix (see @fig-game-correlation-matrix and @tbl-game-multicollinearity).

```{r}
game_cov <- cov %>%
  group_by(match_id) %>%
  mutate(
    interruption = factor(lead(interruption)),
    change_ends = factor(lead(change_ends))) %>%
  filter(last_pt_game == 1) %>%
  mutate(
    set_victor = case_when(
      last_pt_set == "1" & game_victor == "1" ~ 1,
      last_pt_set == "1" & game_victor == "2" ~ 2,
      .default = 0) %>% factor(),
    lead1_gradient_forward = lead(gradient_forward),
    game_victor = factor(if_else(game_victor == 2, 0, 1)),
    tiebreak_victor = tiebreak_victory) %>%
  select(-tiebreak_victory) %>%
  ungroup()

game_cov_model <- lm_spec %>%
  fit(gradient_forward ~ game_victor:server + server:sex:tournament + game_victor + bet_odds + interruption:game_victor + change_ends:game_victor + 
        tiebreak_victor + set_victor, data = game_cov)

game_cov_men <- game_cov %>% filter(sex == "men")

game_cov_model_men <- lm_spec %>%
  fit(gradient_forward ~ game_victor:server + server:tournament + game_victor + bet_odds + interruption:game_victor + change_ends:game_victor + 
        tiebreak_victor + set_victor, data = game_cov_men)

game_cov_women <- game_cov %>% filter(sex == "women")

game_cov_model_women <- lm_spec %>%
  fit(gradient_forward ~ game_victor:server + server:tournament + game_victor + bet_odds + interruption:game_victor + change_ends:game_victor + 
        tiebreak_victor + set_victor, data = game_cov_women)

game_cov_close <- game_cov %>%
  filter(between(bet_odds, 40, 60))

game_cov_model_close <- lm_spec %>%
  fit(gradient_forward ~ game_victor:server + server:sex:tournament + game_victor + bet_odds + interruption:game_victor + change_ends:game_victor  + 
        tiebreak_victor + set_victor, data = game_cov_close)

game_cov_close_men <- game_cov_close %>% filter(sex == "men")

game_cov_model_close_men <- lm_spec %>%
  fit(gradient_forward ~ game_victor:server + server:tournament + game_victor + bet_odds + interruption:game_victor + change_ends:game_victor  + 
        tiebreak_victor + set_victor, data = game_cov_close_men)

game_cov_close_women <- game_cov_close %>% filter(sex == "women")

game_cov_model_close_women <- lm_spec %>%
  fit(gradient_forward ~ game_victor:server + server:tournament + game_victor + bet_odds + interruption:game_victor + change_ends:game_victor +
        tiebreak_victor + set_victor, data = game_cov_close_women)
```

In @tbl-game-level, we find that winning a game tends to increase future momentum (.0238). The effect size is considerable; a 4.1 percentile increase in future momentum. The effect is positive and significant for both men (.0259) and women (.204). Winning a set, however, tends to increase future momentum by an even larger amount (.032). This equates to a 5.43 percentile increase. Interestingly, this effect size is larger for women (.0386) than men (.0287). In the full combined model, future momentum decreases (-.0187) with a tiebreak victory (conditional on winning a set). However, in the reduced combined model, the future momentum increases (.0099) with a tiebreak victory (conditional on winning a set). These results are similar and exacerbated among men, but no difference exists among women.

We find that an interruption in play tends to decrease (-.0051) the future momentum of the player winning the previous game. This is significant ($\alpha = .05$) in the full model, but insignificant in the reduced model. However, the effect size increases in the reduced model (-.009), suggesting that this decline in future momentum is legitimate. The effect size remains stable and negative among both men (-.005) and women (-.0052). Interruptions in play are highly correlated with changing ends of the court, so we verify the interruption estimates by removing the **change ends** covariate. If **change ends** is removed from the model, the coefficient for **interruption** still shows a negative association with future momentum (-.0054). The effect size is similar for both men (-.0062) and women (-.004). In contrast, we find little evidence that a change of ends impacts future momentum with and without interruptions included in the model.

\newpage

```{=latex}
\begin{spacing}{1}
```

```{r}
#| label: tbl-game-level
#| tbl-cap: "What Impacts Momentum: Game Level"
prep_linear_tables(game_cov_model, game_cov_model_close, game_cov_model_men, game_cov_model_close_men, game_cov_model_women, game_cov_model_close_women) %>% 
  gt()
  # flextable() %>%
  # align(align = "center", part = "all") %>%
  # add_header_row(
  #   values = c("", "Combined", "Men", "Women"),
  #   colwidths = c(1, 2, 2, 2), top = TRUE) %>%
  # set_header_labels(values = c("Term", "Full", "Reduced", "Full", "Reduced", "Full", "Reduced")) %>%
  # width(j = 1, width = 1.3) %>% 
  # merge_v(j = ~Term)
```

```{=latex}
\end{spacing}
```

\newpage

\begin{spacing}{1}
\vspace*{.1mm}
\begin{center}
\setlength{\parskip}{12pt}

CHAPTER SIX

CONCLUSION

\setlength{\parskip}{24pt}

\textit{Discussion}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

\noindent{\textit{Does Momentum Exist?}}

The results reject the notion that a player's odds of winning a tennis point are constant throughout an entire match. We suggest that the outcomes of individual tennis points are not independent and identically distributed (Klaasen & Magnus, 2001). The outcomes of consecutive points are at least minimally autocorrelated. From this, we conclude that each individual tennis match does not follow a purely random walk with drift.

While controlling for structural components, players' skill, and the server, we find that a half-unit increase in backward momentum tends to increase a player's odds of winning a point by 8%. These results lead to two immediate conclusions. First, an 8% increase in the odds of winning a point is meaningful in professional tennis. Even the best players tend to win only 53-54% of the points in their career. If a player begins with a 50% chance to win a point, an 8% increase in odds corresponds to a win probability of 53.7%. Over a 100-200 point match, this difference will be significant. Second, the effect of momentum on winning is less than many would expect. A player can dominate for a long stretch and gain only a mild boost in individual point win probability. Many unknown and uncontrollable factors impact the result of point, and perhaps onlookers tend to attribute too much weight on past points.

These findings contribute more evidence to the conclusion that previous points do impact the results of future points (Klaasen & Magnus, 2001; Gauriot & Page, 2019), but they affirm the notion that the momentum effect plays a small part in the outcome of an individual tennis point. This rejects the claims of Gilovich, Vallone, & Tversky (1985); Albright (1989); etc. that past results do not impact future results, while giving credence to their arguments. We find that the momentum effect does exist and that past results are correlated with future results, but the effect sizes are small and drastically overestimated in popular culture.

Interestingly, these results differ greatly among male and female players. Men can expect an increase in odds of point victory of 9.9%, while women experience an increase of only 5.3%. This disparity contributes to the hypothesis that male tennis players are more prone to the momentum effect than female players (Depken, Gandar, & Shapiro, 2022; Page & Coates, 2017; Gauriot & Page, 2019), lending support to the biological framework of momentum. This theory proposes that winning produces positive chemicals that increase the likelihood of further success (Robertson, 2012). Men tend to have more of these chemicals, so they should experience a larger "winner effect" (Bezuglov et al., 2023).

\noindent{\textit{What Factors Impact Momentum?}}

In our second study, we assess the effect of several features on the future trajectory of the match, a concept we term future momentum. While controlling for structural components and player skill, we find strong and meaningful evidence that converting a break point and striking an ace tend to increase future momentum, while saving a break point tends to decrease future momentum on the point level. We find evidence that winning points is positively associated with future momentum for male players. On the game level, our results show that winning a game and a set tend to increase future momentum, while an interruption in play decreases future momentum for the winning player. In general, we find a stronger effect size for men than women.

We can conclude that winning tends to lead to more winning. Winning a point, game, and set all are associated with an increase in future momentum, regardless of the conditions. These results support the notion of the winner effect (Robertson, 2012), and add to the evidence that winning points (Klaasen & Magnus, 2001; Gauriot & Page, 2019), games (Meier et al., 2020), and sets (Page & Coates, 2017) leads to future success in professional tennis.

This winner effect, however, is not consistent across each situation. Notably, our results demonstrate that the impact of winning increases as the significance of victory increases. Winning a point (.0035), game (.0238), and set (.0309) all tend to increase future momentum on the point or game level. This suggests that as players progress closer to their goal of winning a match, they tend to play better. This result is demonstrated most clearly in comparing the effect of winning a set among men and women. For both men and women, winning a set is a vital achievement in the course of a match. To win a match, men need to win three sets, while women only need to win two. Correspondingly, the effect of winning a set on the future momentum is much higher for women (.0375) than men (.0276). This difference is further accentuated, because most covariates tend to have a stronger effect for men than women. We propose that winning a set tends to increase future momentum more for women than men, because it carries more strategic significance. That is, winning a set brings female players closer to their end goal of winning a match than male players. These results support the economic theory of strategic momentum (Mago, Sheremeta, & Yates 2012; Depken, Gandar, & Shapiro, 2022).

Next, we consider the effect of winning a tiebreak. We find that, conditional on winning a set, tiebreaks have a strong negative association in the full model. This makes intuitive sense. Tiebreaks are an indicator of a close match, so the future momentum associated with winning a set should be lessened. However, in men's matches with close pre-match betting odds, the effect of winning a tiebreak is actually *positive*, conditional on winning a set. We suggest that these male players are anticipating a close match, so they receive a psychological boost if they win a tiebreak. These results fit surprisingly well with the findings of Page & Coates (2017). Their analysis detects a winner effect among male players in close matches. Their research, like ours, finds no such effect for female players.

Our results strengthen the conclusion that converting a break point is associated with an increase in future success (Meier et al., 2020). This is arguably our strongest and most meaningful result. Interestingly, we find that players who nearly convert a break point still tend to experience an increase (albeit much smaller) in future success. Perhaps these players experience a psychological boost from nearly achieving their goal? Or perhaps these near disastrous situations wear on their opponent? Regardless, these findings tend to conflict with the philosophy of the economic framework, which suggests that momentum arises from a favorable change in a game's structure or score.

In addition, we can conclude that interruptions in play tend to slightly diminish the winner effect for both male and female players. While the effect size is small, we find consistent evidence that an interruption in play decreases the future momentum of the player winning the most recent game. The winning player still tends to experience an increase in future momentum, but the increase is smaller than if no interruption had occurred. These results affirm the findings of Meier et al. (2020), who conclude that the momentum is primarily a psychological effect. Interruptions in play permit losing players to recover and winning players to lose confidence. 

Moreover, these findings support the psychological concept that certain prominent events can serve as catalysts of momentum (Adler & Adler, 1978). We find strong evidence that striking an ace tends to meaningfully increase future momentum above and beyond that of winning a point. We also find mixed evidence that striking winners increases future momentum. These conclusions are intuitive. They suggest that, regardless of the situation, winning in memorable or dominating ways can have an outsized effect on the future trend of a match.

Our findings indicate that the overall source of momentum is a mixture of the biological, psychological, and strategic frameworks. Male players are more susceptible to momentum than female players. Interruptions diminish momentum, and aces augment it. Female players tend to experience a stronger benefit from winning a set than male players. We suggest that all three frameworks interact to form momentum.

\begin{spacing}{1}
\begin{center}
\setlength{\parskip}{12pt}

\textit{Model Improvement}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

While our models give satisfactory results, we suggest several improvements that may reduce error and strengthen our assumptions.

The pre-match betting odds are an essential structural control for our model. It's accuracy and performance reduces the confounding effect of *player skill* and preserves the true relationship between momentum and results. In this paper, we compare the betting odds from Pinnacle Sports, Bet365, and the official tour rankings, and select the measurement with the most predictive power. Instead, we suggest improving these betting odds with a composite score than synthesizes the explanatory power from all three measurements. It is likely that certain measurements perform better among male or female matches, at specific tournaments, or during certain years.This composite score should permit more nuance and will be a more accurate estimate of the player's skill entering a match.

It is likely that the players' skill entering a match is a stochastic process that varies from match to match. Ideally, the players' true skill entering a match randomly deviates from the betting odd's estimated skill. We suggest introducing a method that estimates and accounts for this potential deviation. Perhaps a hierarchical model (Royle & Dorazio, 2008) would resolve this problem. If successful, this will help to preserve momentum's true relationships and discover more nuanced associations.

By construction, our measurements of backward and future momentum are highly autocorrelative. As it should be, a player's momentum at point *t* is highly related to his or her momentum at point *t+1*, regardless of the results at *t*. Thus, while the error structure of our models are linear and homoscedastic, it has a high autocorrelation. We suggest implementing an autoregressive error structure to account for the high autocorrelation among the residuals.

Now, we suggest three minor modifications on our method for measuring momentum. First, we adjust the point margin curve for the server of the match with the match's serve impact. This assumes that the value of serving is constant throughout an entire match. This assumption suffices for our purposes, but a more complex method may further improve our computation of momentum. Ideally, the server should have no association with backward or future momentum. Second, we smoothed the point margin curve with our smoothing parameter, $\alpha$, at 0.1. It would be helpful to compare our results with different values of $\alpha$. We do not anticipate large shifts, and this robustness check will strengthen our conclusions. It may also shed light on the ideal value of the $\alpha$ parameter. Second, we use a simple secant line to approximate the forward and backward derivatives. A more complex backward and forward differentiation method may provide a more accurate measurement of momentum.

\begin{spacing}{1}
\begin{center}
\setlength{\parskip}{12pt}

\textit{Future Work}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

There is still much left to do and many questions left unanswered on the holistic effect of momentum in professional tennis. Ideally, this paper serves as introductory study that ushers in a wave of research on the magnitude and importance of momentum within a tennis match.

\noindent{\textit{Next Steps}}

For verification of the results, we suggest a simulation study that produces a series of matches with various pre-determined win-rates. These matches will be tantamount to random-walks with a drift. The outcomes of the points in the simulated matches should be completely random. That is, there should be no momentum effect present. Then, one can apply the same methods and models in this study to the simulated matches and compare the results. If no meaningful momentum effect is discovered among the simulated matches, then our results will be verified. Otherwise, if the results are comparable, then our conclusions will be seriously brought into question.

Our measurements of backward momentum add value to existing in-match predictions that assume tennis points are identically distributed (Klaasen & Magnus, 2001). In the future, these- or improved- measurements of backward momentum may be utilized in machine learning models that predict the results of matches as they progress.

Within a tennis match, certain points have a larger impact (or leverage) on the outcome of the match than others. It is reasonable to conclude that players afford differing levels of effort and mental energy to various points, depending on the points' leverage. Perhaps, this increased focus amplifies a point's impact on future momentum. One could develop a measurement for leverage and assess the relationship between a point's leverage and the future momentum of the match.

Moreover, we hypothesize that momentum behaves differently at different levels of tournaments and among different age groups. This study focuses specifically at professional players competing at the highest levels. Perhaps these same players will experience different momentum effects at lower-level (and less consequential) tournaments. Moreover, little research has been conducted to assess the momentum effect in college or youth tennis. Are younger players more prone to the momentum effect? Do experienced players learn to harness or ignore momentum? These questions are some of the many still to be answered.

\noindent{\textit{Other Methods}}

In this study, we make the large and rather incorrect assumption that all players (of the same sex) experience momentum in identical manners and to identical degrees. Our model's coefficients report the average effects felt among all sampled players. We suggest implementing a random effects model (Gelman & Hill, 2007) that adjusts the effects of momentum for each player. These nuanced and interactive results may shed light on the types of players that are more or less prone to the momentum effect. Additionally, it may be beneficial to categorize players into pre-determined player types before this analysis (Skinner, 2023). This will drastically reduce both the number of levels in the random effects model and the model's variability. Altogether, identifying individual player's relationships with momentum may illuminate certain psychological or demographic trends of interest. Very little research has been conducted concerning individual responses to momentum, and this random effects model may be a very fruitful place to begin. In addition to strengthening momentum literature as a whole, these insights may provide immense strategic or training benefits for individual players.

Momentum is a force that gradually builds with a series of successes and slowly diminishes as time passes. This concept fits with a self-exciting spatio-temporal point process model (Reinhart, 2017). One could analyze momentum as a force that effects itself and changes as an explicit function of time. Under this paradigm, events compound to form momentum and are entirely related. In our model, we found no significant association between momentum and the length of points, but it is possible that winning long points is a *self-exciting process*. Perhaps winning one long point produces negligible momentum, but winning four in a row creates a significant effect. Additionally, as a function of time, a self-exciting model may prove useful in the understanding the effects of interruptions in play on momentum.

\begin{spacing}{1}
\begin{center}
\setlength{\parskip}{12pt}

\textit{Conclusion}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

In response to several studies that identify evidence for momentum in professional tennis in specific situations, this paper proposes a comprehensive definition for a player's momentum in a match. Momentum is the players' instantaneous point win rate at any point during the match. We utilize two estimations for the momentum: the backward momentum and future momentum. The backward momentum describes a players' momentum entering a point. We estimate the backward momentum with the backward approximation of the exponentially smoothed point-margin curve. The future momentum gauges the trajectory of the match after a point. The future momentum is estimated with the forward approximation of the forward exponentially smoothed point-margin curve.

With these measurements, we evaluate the relationship between the players' past performance on their odds of winning the next point. Namely, we use a logistic regression to assess the relationship between backward momentum and the victor of the next point. While controlling for several structural variables, we find that a half-unit increase in a player's backward momentum tends to increase a player's odds of winning a point by 8.03%. While significant for both men and women, this effect size is larger for men (9.85%) than women (5.31%).

Secondly, we assess the impact of various factors on the future trajectory of a match. As a whole, our results confirm and synthesize the findings of established peer-reviewed studies. We find that winning points, games, and sets tend to increase a player's future momentum. The more significant the victory, the larger the expected increase in future momentum. Players tend to experience an increase in future momentum after converting a break point and striking an ace. An interruption in play tends to diminish the effect of winning on future momentum. As a rule, these effect sizes are larger for men than women. Many of these findings are not unique to momentum literature, but this is the first study that integrates the effects into one model.

We conclude that momentum does exist in professional tennis. That is, the outcome of points in a tennis match are not independent, and past results do have impact on future results. However, it is important to acknowledge that many factors impact the outcome of a tennis point, and the momentum effect is often less than one would initially expect. Moreover, we can conclude that both important and memorable events tend to impact a player's future momentum. Important match landmarks (like winning a game, set, or breaking serve) tend to increase a player's future performance, while memorable events (like aces and winners) can serve as catalysts of momentum that spur on future success. Conversely, as time progresses, the effect of past events on future results tends to diminish. In essence, this thesis has demonstrated that momentum exists and has begun to uncover pieces of the complex relationship between past and future performance. These findings give us a greater appreciation for the sport and a better understanding of the nuanced interplay between skill and psychological momentum on the court.

\newpage

\begin{spacing}{1}
\topskip0pt
\vspace*{\fill}

\begin{center}

APPENDIX

\vspace*{\fill}
\end{center}
\end{spacing}

\newpage

\begin{spacing}{1}
\vspace*{.1mm}
\begin{center}

APPENDIX

\end{center}
\end{spacing}
\setlength{\parskip}{24pt}

The appendix includes additional figures and tables. For more context, please refer to the main text. The appendix is divided by the chapter to which it applies.

\setcounter{table}{0}
\renewcommand{\thetable}{A\arabic{table}}

\setcounter{figure}{0}
\renewcommand{\thefigure}{A\arabic{figure}}

\setlength{\parskip}{12pt}
\begin{spacing}{1}
\begin{center}

\textit{Methodology}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

As we adjusted the point margin for the server, we assume that serve impact is additive. That is, we assume the overall impact from serving does not change as the point margin changes. In @fig-serve-impact-pm, we display the server's win probability at each point margin in our data set. The dashed line is the overall win rate for the server. To reduce noise, we only include point margins where at least 1100 points have been played. The figure shows that the serve impact does decrease slightly as the point margin increases for both men and women. However, the difference is not large enough to meaningfully impact our measurement of momentum. Thus, we continue with the assumption that serve impact is additive. Moreover, it is likely that this figure is impacted by sampling bias. Fewer points are played with large point margins, and these matches tend to have lower serve win rates.

```{r}
#| label: fig-serve-impact-pm
#| fig-cap: "Serve Impact by Point Margin"

gs %>%
  mutate(
    point_margin = abs(p1_points_won - p2_points_won),
    s_win = if_else(server == point_victor, 1, 0),
    sex = factor(sex, levels = c("1", "0"))) %>%
  group_by(match_id) %>%
  group_by(point_margin, sex) %>%
  summarise(
    s_win = mean(s_win),
    points = n()) %>%
  filter(points > 1100) %>%
  ggplot(aes(x = point_margin, s_win)) +
  geom_point(aes(color = sex), size = .8) +
  geom_smooth(aes(color = sex), se = FALSE) +
  scale_color_manual(name = 'Sex',
                     labels = c('1' = "Male", '0' = "Female"),
                     values = c('1' = 'cadetblue3', '0' = 'indianred2')) +
  geom_segment(aes(x = 0, y = .641, xend = 33, yend = .641), linetype = "dashed", color = "cadetblue3") +
  geom_segment(aes(x = 0, y = .570, xend = 25, yend = .570), linetype = "dashed", color = "indianred2") +
  labs(x = "Point Margin", y = "Server Win Rate") +
  theme(plot.title=element_blank())
```

Our second assumption regarding serve impact is that the server win percentage is constant over the course of a match. In @fig-serve-impact-match, we visualize the server's win percentage at each point in a match. To reduce noise, we only include points with at least 500 observations. We find that the server win rate does not meaningfully change over the course of a match.

```{r}
#| label: fig-serve-impact-match
#| fig-cap: "Serve Impact over Time"

gs %>%
  mutate(
    s_win = if_else(server == point_victor, 1, 0),
    # pt_group = (point_no - 1)%/%3,
    sex = factor(sex, levels = c("1", "0"))) %>%
  group_by(point_no, sex) %>%
  summarise(
    s_win = mean(s_win),
    points = n()) %>%
  filter(points > 500) %>%
  ggplot(aes(x = point_no, s_win)) +
  geom_point(aes(color = sex), size = .8) +
  geom_smooth(aes(color = sex), se = FALSE) +
  scale_color_manual(name = 'Sex',
                     labels = c('1' = "Male", '0' = "Female"),
                     values = c('1' = 'cadetblue3', '0' = 'indianred2')) +
  labs(x = "Point Number", y = "Server Win Rate") +
  theme(plot.title=element_blank())
```

@tbl-interpret supplements the figures in Describing Momentum. It contains the means and intervals of backward momentum in various conditions.

```{=latex}
\begin{spacing}{1}
```

```{r}
#| label: tbl-interpret
#| tbl-cap: "Momentum Estimates for Example Sequences"

table_interpret <- gs %>%
  select(match_id, point_victor, gradient_backward, gradient_forward, point_no) %>%
  mutate(
    match_id = str_c(match_id, "_flip"),
    point_victor = if_else(point_victor == 1, 2, 1),
    gradient_backward = -gradient_backward,
    gradient_forward = -gradient_forward) %>%
  bind_rows(gs %>% select(point_victor, match_id, gradient_backward, gradient_forward, point_no)) %>%
  group_by(match_id) %>%
  mutate(
    point_victor = if_else(point_victor == 2, 0, point_victor),
    p1_points_won = cumsum(point_victor),
    fifteen_in_a_row = if_else((p1_points_won - lag(p1_points_won, 15) == 15), gradient_backward, NA),
    sixteen_out_of_twenty = if_else((p1_points_won - lag(p1_points_won, 20) == 16), gradient_backward, NA),
    twelve_out_of_fifteen = if_else((p1_points_won - lag(p1_points_won, 15) == 12), gradient_backward, NA),
    ten_in_a_row = if_else((p1_points_won - lag(p1_points_won, 10) == 10), gradient_backward, NA),
    eight_out_of_ten = if_else((p1_points_won - lag(p1_points_won, 10) == 8), gradient_backward, NA),
    four_out_of_five = if_else((p1_points_won - lag(p1_points_won, 5) == 4), gradient_backward, NA),
    five_in_a_row = if_else((p1_points_won - lag(p1_points_won, 5) == 5), gradient_backward, NA),
    three_in_a_row = if_else((p1_points_won - lag(p1_points_won, 3) == 3), gradient_backward, NA)) %>%
  ungroup() %>%
  select(contains("row"), contains("out_of")) %>%
  filter(!is.na(fifteen_in_a_row) | !is.na(ten_in_a_row) | !is.na(five_in_a_row) | !is.na(three_in_a_row) | !is.na(sixteen_out_of_twenty) | !is.na(eight_out_of_ten) | !is.na(twelve_out_of_fifteen) | !is.na(four_out_of_five))

int_levels <- c("fifteen_in_a_row", "ten_in_a_row", "five_in_a_row", "three_in_a_row", "sixteen_out_of_twenty", "twelve_out_of_fifteen", "eight_out_of_ten", "four_out_of_five")

table_interpret %>%
  pivot_longer(everything(), names_to = "group") %>%
  filter(!is.na(value)) %>%
  mutate(Sequence = factor(group, levels = int_levels)) %>%
  group_by(Sequence) %>%
  summarize(
    `2.5%` = quantile(value, .025, na.rm = TRUE),
    Mean = mean(value, na.rm = TRUE),
    `97.5%` = quantile(value, .975, na.rm = TRUE),
    `Sample Size` = n()) %>%
  mutate(across(where(is.numeric), ~round(.x, digits = 3)),
         Sequence = str_replace_all(Sequence, "_", " "),
         Sequence = str_to_title(Sequence)) %>%
  gt()
  # flextable() %>%
  # align(align = "center", part = "all") %>%
  # width(j = 1, width = 1.6) %>%
  # width(j = 5, width = 1) %>%
  # colformat_double(j = c(2,4), digits = 3) %>%
  # colformat_double(j = 5, digits = 0)
```

```{=latex}
\end{spacing}
```

\begin{spacing}{1}
\begin{center}
\setlength{\parskip}{12pt}

\textit{Results}

\setlength{\parskip}{0pt}
\end{center}
\end{spacing}

\begin{spacing}{1}

\noindent{\textit{Does Momentum Exist?}}

\end{spacing}

@fig-backward-linearity displays figures supporting the logistic regression's linearity assumption.

```{r}
#| label: fig-backward-linearity
#| fig-cap: "Backward Momentum Linearity Assumption"

# linearity assumption for logistic regression
cov %>%
  mutate(
    victor_res = exist_momentum_combined$fit$coefficients[2]*lag1_gradient_backward + exist_momentum_combined$fit$residuals) %>%
  sample_n(1000) %>%
  ggplot(aes(x = lag1_gradient_backward, y = victor_res)) +
  geom_point() +
  geom_smooth(color = "cadetblue3", method = "lm", linetype = "dashed", se = F) +
  geom_smooth(color = "indianred3", se = F)
```

The Durbin and Watson test statistic measures the impact of serial correlation or autocorrelation on a model (Durbin & Watson, 1971). Perfect positive autocorrelation yields a test statistic of 0 and perfect negative autocorrelation yields a value of 4. Typically, test statistics within 1.5 and 2.5 are consider to be minimal. @tbl-exist-autocorrelation displays the results of the tests. These results suggest that the impact of autocorrelation on our coefficients is minimal.

```{=latex}
\begin{spacing}{1}
```

```{r}
#| label: tbl-exist-autocorrelation
#| tbl-cap: "Backward Momentum Autocorrelation"

# autocorrelation
# lmtest::dwtest(point_victor ~ lag1_gradient_backward, data = cov %>% mutate(point_victor = as.numeric(point_victor)), alternative = "two.sided")

# lmtest::dwtest(point_victor ~ tournament:sex:server + lag1_gradient_backward + bet_odds, data = cov %>% mutate(point_victor = as.numeric(point_victor)), alternative = "two.sided")

tibble("Formula" = c("Backward Momentum", "Backward Momentum and Controls"),
       "Durbin Watson Statistic" = c(1.9408, 1.9992),
       "P Value" = c("~0", ".998")) %>%
  gt()
  # flextable() %>%
  # align(align = "center", part = "all") %>%
  # width(j = 1, width = 2.5) %>%
  # width(j = c(2), width = 1.5) %>%
  # colformat_double(j = 2, digits = 4)
```

```{=latex}
\end{spacing}
```

```{r}
app_prep_table <- function(fit, name){
  fit %>%
    tidy() %>%
    clean_names() %>%
    select(-statistic) %>%
    filter(!str_detect(term, "tournament")) %>%
    mutate(
      across(where(is.numeric), ~round(.x, digits = 4)),
      symbol = case_when(
        p_value < .001 ~ "***",
        p_value < .01 ~ "**",
        p_value < .05 ~ "*",
        .default = ""),
      estimate = str_c(as.character(format(estimate, scientific = FALSE)), symbol),
      std_error = str_c("(", format(std_error, scientific = FALSE), ")")) %>%
    slice(1:3) %>%
    mutate(term = c("Intercept", "backward_momentum", "bet_odds")) %>%
    pivot_longer(cols = c(estimate, std_error), names_to = "metric", values_to = name) %>%
    select(-p_value, -symbol, -metric)
}

app_prep_log_table <- function(men_fit, women_fit, combined_fit){
  em_men <- men_fit %>%
    app_prep_table("men") %>%
    select(men)
  
  em_women <- women_fit %>%
    app_prep_table("women") %>%
    select(women)
  
  combined_fit %>%
    app_prep_table("combined") %>%
    bind_cols(em_men) %>%
    bind_cols(em_women) %>%
    mutate(
      term = str_replace_all(term, "_", " "),
      term = str_to_title(term),
      term = dplyr::recode(term,
                     "Bet Odds" = "Pre-Match Win Probability")) %>%
    rename_with(str_to_title)
}
```

@tbl-full-log-odds displays the log odds for all variables in the model evaluating the relationship between backward momentum and point victor. The dependent variable is player 1's odds of winning the next point.

```{=latex}
\begin{spacing}{1}
```

```{r, ft.keepnext = FALSE}
#| label: tbl-full-log-odds
#| tbl-cap: "Momentum Exist - All Variables"

exist_momentum_men %>%
  tidy() %>%
  clean_names() %>%
  select(-statistic) %>%
  mutate(
    across(where(is.numeric), ~round(.x, digits = 4)),
    symbol = case_when(
      p_value < .001 ~ "***",
      p_value < .01 ~ "**",
      p_value < .05 ~ "*",
      .default = ""),
    `Log Odds` = str_c(as.character(format(estimate, scientific = FALSE)), symbol),
    term = str_remove(term, "sex"),
    term = str_replace(term, "server0", "returner"),
    term = str_replace(term, "open", "_open"),
    term = str_remove(term, "tournament"),
    term = str_remove(term, "p1_"),
    term = str_remove_all(term, "1"),
    term = str_replace_all(term, "_", " "),
    term = str_replace_all(term, ":", " & "),
    term = str_replace_all(term, "lag gradient backward", "backward momentum"),
    term = str_replace_all(term, "bet odds", "Pre-Match Win Probability"),
    term = str_to_title(term),
    term = str_replace(term, "Us", "US"),
    term = str_replace(term, "Aus", "Australian")) %>%
  slice(-18, -22) %>%
  select(-p_value, -symbol, -estimate) %>%
  rename("Standard Error" = "std_error") %>%
  relocate(`Log Odds`, .before = `Standard Error`) %>%
  rename_with(str_to_title) %>%
  gt()
  # flextable() %>%
  # align(align = "center", part = "all") %>%
  # width(j = 1, width = 2.5) %>%
  # width(j = 3, width = 1.2) %>%
  # colformat_double(j = 3, digits = 4)
```

```{=latex}
\end{spacing}
```

```{r}
#| label: fig-victor-win-percentage
#| fig-cap: "Victor Win Percentage"

gs %>% group_by(match_id) %>% summarise(
  points_won_by_winner = sum(match_victor == point_victor)/n()) %>%
  ggplot() +
  geom_density(aes(x = points_won_by_winner), color = "indianred3") +
  # geom_segment(aes(x = .541, xend = .541, y = 0, yend = 11), linetype = "dashed", color = "indianred3") +
  labs(y = "", title = "", x = "") +
  scale_y_continuous(breaks = NULL) +
  scale_x_continuous(labels = scales::percent) +
  theme(plot.title=element_blank())
```

In @fig-exist-roc, we display the model's RoC Curve, another common tool for estimating the strength of a model. While the model predicts more accurately than a coin flip, it lacks powerful predictive capability, and the area under the curve is only .645.

```{r}
#| label: fig-exist-roc
#| fig-cap: "RoC Curve"
full %>%
  roc_curve(truth = point_victor, .pred_0) %>%
  mutate(
    index = row_number() - 1,
    false_positive = 1 - specificity) %>%
  filter(index %% 100 == 0) %>%
  ggplot() +
  geom_line(aes(y = sensitivity, x = false_positive)) +
  geom_segment(aes(x = 0, y = 0, xend = 1, yend = 1), linetype = "dashed") +
  labs(y = "Sensitivity", x = "1 - Specificity") +
  theme(plot.title=element_blank())
```

In @fig-betting-odds-server-momentum, we display backward momentum's effect on the point victor with varying betting odds and servers. In this situation, we describe high betting odds as a 99% implied win probability, even betting odds as a 50% implied win probability, and low betting odds as a 1% implied win probability. For all curves, the estimates are for women playing at Wimbledon.

```{r}
#| label: fig-betting-odds-server-momentum
#| fig-cap: "Backward Momentum on Win Probability"

# womens varying betting odds, assume Wimbledon
predicted_women_vary_bet_odds <- tibble(
  backward_gradient = seq(-1, 1, by = .01),
  odds_wswh = exp(e_co$estimate[1] + e_co$estimate[4] + backward_gradient*(e_co$estimate[2] + e_co$estimate[5]) + 99*(e_co$estimate[3] + e_co$estimate[6]) + e_co$estimate[21]),
  pred_wswh = odds_wswh/(1+odds_wswh),
  odds_wswe = exp(e_co$estimate[1] + e_co$estimate[4] + backward_gradient*(e_co$estimate[2] + e_co$estimate[5]) + 50*(e_co$estimate[3] + e_co$estimate[6]) + e_co$estimate[21]),
  pred_wswe = odds_wswe/(1+odds_wswe),
  odds_wswl = exp(e_co$estimate[1] + e_co$estimate[4] + backward_gradient*(e_co$estimate[2] + e_co$estimate[5]) + 1*(e_co$estimate[3] + e_co$estimate[6]) + e_co$estimate[21]),
  pred_wswl = odds_wswl/(1+odds_wswl),

  odds_wrwh = exp(e_co$estimate[1] + e_co$estimate[4] + backward_gradient*(e_co$estimate[2] + e_co$estimate[5]) + 99*(e_co$estimate[3] + e_co$estimate[6]) + e_co$estimate[14]),
  pred_wrwh = odds_wrwh/(1+odds_wrwh),
  odds_wrwe = exp(e_co$estimate[1] + e_co$estimate[4] + backward_gradient*(e_co$estimate[2] + e_co$estimate[5]) + 50*(e_co$estimate[3] + e_co$estimate[6]) + e_co$estimate[14]),
  pred_wrwe = odds_wrwe/(1+odds_wrwe),
  odds_wrwl = exp(e_co$estimate[1] + e_co$estimate[4] + backward_gradient*(e_co$estimate[2] + e_co$estimate[5]) + 1*(e_co$estimate[3] + e_co$estimate[6]) + e_co$estimate[14]),
  pred_wrwl = odds_wrwl/(1+odds_wrwl))

predicted_women_vary_bet_odds %>%
  pivot_longer(cols = c(pred_wswh, pred_wswe, pred_wswl, pred_wrwh, pred_wrwe, pred_wrwl), names_to = "type", values_to = "probability") %>%
  select(backward_gradient, type, probability) %>%
  mutate(
    `Bet Odds` = case_when(
      str_detect(type, "wh") ~ "High",
      str_detect(type, "wl") ~ "Low",
      str_detect(type, "we") ~ "Even",
      .default = NA),
    Server = case_when(
      str_detect(type, "ws") ~ "Server",
      str_detect(type, "wr") ~ "Returner",
      .default = NA),
    `Bet Odds` = factor(`Bet Odds`, levels = c("High", "Even", "Low"))
    ) %>%
  ggplot() +
  geom_line(aes(x = backward_gradient, y = probability, color = `Bet Odds`, linetype = Server)) +
  scale_color_manual(
    values = c(`Even` = "navyblue", `Low` = "indianred3", `High` = "forestgreen"),
    # breaks = c("Wimbledon", "US Open", "Australian Open", "French Open"),
    # labels = c("Wimbledon", "US Open", "Australian Men", "French Men", "Wimbledon Women", "US Women", "Australian Women", "French Women"),
    name = "Betting Odds") +
  scale_linetype_manual(
        values = c(Server = "solid", Returner = "dashed"),
        name = "") +
  labs(x = "Backward Momentum", y = "Point Win Probability", title = "") +
  scale_y_continuous(labels = scales::percent) +
  theme(plot.title=element_blank())
```

In @fig-approach-assumptions, we test the assumptions of the linear model regressing backward momentum on future momentum. For readability, we take a random sample of 1000 points from the model. This subset appears to support the model's assumptions. The first plot demonstrates that the residuals appear to be normally distributed. The second plot assesses the model's linearity conditions. The third plot evaluates the homogeneity of variance. None of the covariates have any meaningful correlation.

```{r, fig.height = 6}
#| label: fig-approach-assumptions
#| fig-cap: "Assumptions for Second Approach"

# residuals
set.seed(1)
momentum_residuals <- tibble(residual = momentum_relationship$fit$residuals,
                        fitted = momentum_relationship$fit$fitted.values) %>%
  sample_n(1000) %>%
  arrange(residual) %>%
  mutate(
    rank = row_number(),
    ordered_values = (residual - mean(residual))/sd(residual),
    sqrt_ordered_values = sqrt(abs(ordered_values)),
    theoretical_quantiles = qnorm(rank/(n() + 1), 0, 1))

# qq plot
qq_mom <- momentum_residuals %>% ggplot() +
  geom_point(aes(theoretical_quantiles, ordered_values), color = "cadetblue4") +
  geom_abline(intercept = 0, slope = 1, color = "indianred3") +
  labs(title = "Q-Q Plot", x = "Theoretical Quantiles", y = "Ordered Values")

# linearity
linear_mom <- momentum_residuals %>% ggplot(aes(fitted, residual)) +
  geom_point(color = "cadetblue3") +
  geom_smooth(color = "forestgreen", se = FALSE) +
  labs(title = "Linearity", x = "Fitted Values", y = "Residuals")

# homogeneity of variance
homogeneity_mom <- momentum_residuals %>% ggplot(aes(fitted, sqrt_ordered_values)) +
  geom_point(color = "cadetblue3") +
  geom_smooth(color = "forestgreen", se = FALSE) +
  labs(title = "Homogeneity of Variance", x = "Fitted Values", y = "Variation")

qq_mom/linear_mom/homogeneity_mom
```

@tbl-second-full-results displays the full results for the second approach. The dependent variable is future momentum.

\bigskip

```{=latex}
\begin{spacing}{1}
```

```{r}
#| label: tbl-second-full-results
#| tbl-cap: "Momentum Relationship Model Full Results"

prep_linear_table_appendix <- function(model_fit, name){
  model_fit %>% 
    pluck("fit") %>%
    tidy() %>%
    clean_names() %>%
    select(-statistic) %>%
    na.omit() %>%
    mutate(
      across(where(is.numeric), ~round(.x, digits = 4)),
      symbol = case_when(
        p_value < .001 ~ "***",
        p_value < .01 ~ "**",
        p_value < .05 ~ "*",
        .default = ""),
      estimate = str_c(as.character(format(estimate, scientific = FALSE)), symbol),
      std_error = str_c("(", format(std_error, scientific = FALSE), ")")) %>%
    pivot_longer(cols = c(estimate, std_error), names_to = "metric", values_to = name) %>%
    select(-symbol, -p_value)
}

momentum_relationship %>%
  prep_linear_table_appendix("full") %>%
  full_join(momentum_relationship_men %>% prep_linear_table_appendix("men") %>% mutate(term = str_replace_all(term, "tourn", "sexmen:tourn")), by = join_by(term, metric)) %>%
  full_join(momentum_relationship_women %>% prep_linear_table_appendix("women") %>% mutate(term = str_replace_all(term, "tourn", "sexwomen:tourn")), by = join_by(term, metric)) %>%
      mutate(
        term = dplyr::recode(term,
                      "bet_odds" = "Pre-Match Win Probability",
                      "gradient_backward" = "Backward Momentum"),
        term = str_replace_all(term, "_", " "),
        term = str_replace_all(term, ":", " & "),
        term = str_remove(term, "\\("),
        term = str_remove(term, "\\)"),
        term = str_replace_all(term, "server1", "server"),
        term = str_replace_all(term, "server0", "returner"),
        term = str_remove(term, "sex"),
        term = str_remove(term, "tournament"),
        term = str_replace_all(term, "open", " open"),
        term = str_to_title(term),
        term = str_replace(term, "Us", "US"),
        term = str_replace(term, "Aus", "Australian")) %>%
  select(-metric) %>%
  rename_with(str_to_title) %>%
  gt()
  # flextable() %>%
  # align(align = "center", part = "all") %>%
  # merge_v(j = ~Term) %>%
  # width(j = 1, width = 2.5)
```

```{=latex}
\end{spacing}
```

\noindent{\textit{What Factors Impact Momentum?}}

In @fig-point-assumptions, we test the assumptions for the point-level linear regression. For readability, we take a random sample of 1000 points from the model. The first three plots appear to meet all the model's assumptions. The first plot demonstrates that the residuals appear to be normally distributed. The second plot addresses the model's linearity conditions. The third plot evaluates the homogeneity of variance. @tbl-point-multicollinearity and @fig-point-correlation-matrix demonstrates the correlation of the covariates. **Server**, **sex**, **long point**, **break converted**, **break saved**, and **betting odds** are removed from the correlation matrix for readability. They have no large associations with any of the other covariates. Of the included variables, **point victor**, **winner**, and **unforced error** have the largest correlations at about .44. The results from the assumptions tests are almost identical to the reduced model.

```{r, fig.height = 6}
#| label: fig-point-assumptions
#| fig-cap: "Assumptions for Point Level"

# residuals
set.seed(1)
point_residuals <- tibble(residual = cov_model$fit$residuals,
                        fitted = cov_model$fit$fitted.values) %>%
  sample_n(1000) %>%
  arrange(residual) %>%
  mutate(
    rank = row_number(),
    ordered_values = (residual - mean(residual))/sd(residual),
    sqrt_ordered_values = sqrt(abs(ordered_values)),
    theoretical_quantiles = qnorm(rank/(n() + 1), 0, 1))

# qq plot
qq_point <- point_residuals %>% ggplot() +
  geom_point(aes(theoretical_quantiles, ordered_values), color = "cadetblue4") +
  geom_abline(intercept = 0, slope = 1, color = "indianred3") +
  labs(title = "Q-Q Plot", x = "Theoretical Quantiles", y = "Ordered Values")

# linearity
linear_point <- point_residuals %>% ggplot(aes(fitted, residual)) +
  geom_point(color = "cadetblue3") +
  geom_smooth(color = "forestgreen", se = FALSE) +
  labs(title = "Linearity", x = "Fitted Values", y = "Residuals")

# homogeneity of variance
homogeneity_point <- point_residuals %>% ggplot(aes(fitted, sqrt_ordered_values)) +
  geom_point(color = "cadetblue3") +
  geom_smooth(color = "forestgreen", se = FALSE) +
  labs(title = "Homogeneity of Variance", x = "Fitted Values", y = "Variation")

qq_point/linear_point/homogeneity_point
```

```{=latex}
\begin{spacing}{1}
```

```{r}
#| label: tbl-point-multicollinearity
#| tbl-cap: "Point Level Covariates Multicollinearity"

cov_model %>% check_collinearity() %>%
  as_tibble() %>%
  arrange(desc(VIF)) %>%
  select(Term, VIF) %>%
  mutate(across(where(is.numeric), ~round(.x, digits = 4))) %>%
  gt()
  # flextable() %>%
  # align(align = "center", part = "all") %>%
  # width(j = 1, width = 2)
```

```{=latex}
\end{spacing}
```

```{r}
#| label: fig-point-correlation-matrix
#| fig-cap: "Point Level Covariates Correlation Matrix"

cov_cor <- cov %>%
  select(point_victor, p1_winner, p2_winner, p1_ace, p2_ace, p1_double_fault, p2_double_fault, p1_unf_err, p2_unf_err) %>%
  mutate(
    across(point_victor:p2_unf_err, ~as.double(.x))) %>%
  correlate()

cov_cor %>% rplot(.order = "alphabet") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

In @tbl-point-full-results, we display the full results for the point-level linear model. The dependent variable is **future momentum**. Many covariates apply for both player 1 and player 2. We use the prefix "P1" to denote player 1 and "P2" to denote player 2 for all such variables.

\bigskip

```{=latex}
\begin{spacing}{1}
```

```{r}
#| label: tbl-point-full-results
#| tbl-cap: "Point Level Model Full Results"

prep_linear_tables_appendix <- function(comb_full, comb_reduced, men_full, men_reduced, women_full, women_reduced){
  c1 <- prep_linear_table_appendix(comb_reduced, "Combined Reduced")
  c2 <- prep_linear_table_appendix(comb_full, "Combined Full") %>%
    left_join(c1, by = join_by(term, metric))
  m1 <- prep_linear_table_appendix(men_reduced, "Men Reduced") %>% mutate(term = str_replace_all(term, "tourn", "sexmen:tourn"))
  m2 <- prep_linear_table_appendix(men_full, "Men Full") %>% mutate(term = str_replace_all(term, "tourn", "sexmen:tourn")) %>%
    left_join(m1, by = join_by(term, metric))
  w1 <- prep_linear_table_appendix(women_reduced, "Women Reduced") %>% mutate(term = str_replace_all(term, "tourn", "sexwomen:tourn"))
  w2 <- prep_linear_table_appendix(women_full, "Women Full") %>% mutate(term = str_replace_all(term, "tourn", "sexwomen:tourn")) %>%
    left_join(w1, by = join_by(term, metric))

  full_join(c2, m2, by = join_by(term, metric)) %>%
    left_join(w2, by = join_by(term, metric)) %>%
    mutate(
      term = str_replace_all(term, "unf_err1", "unforced_error"),
      term = str_replace_all(term, "double_fault1", "double_fault"),
      term = str_replace_all(term, "_", " "),
      term = str_replace_all(term, ":", " & "),
      term = str_replace_all(term, "server1", "server"),
      term = str_replace_all(term, "server0", "returner"),
      term = str_remove(term, "sex"),
      term = str_remove(term, "tournament"),
      term = str_remove(term, "\\("),
      term = str_remove(term, "\\)"),
      term = str_replace_all(term, "open", " open"),
      term = str_replace_all(term, "victor1", "victor"),
      term = str_replace_all(term, "victor0", "loser"),
      term = str_replace_all(term, "ace1", "ace"),
      term = str_replace_all(term, "winner1", "winner"),
      term = str_replace_all(term, "point1", "point"),
      term = str_replace_all(term, "ends1", "ends"),
      term = str_replace_all(term, "interruption1", "interruption"),
      term = str_to_title(term),
      term = str_replace(term, "Us", "US"),
      term = str_replace(term, "Aus", "Australian"),
      term = dplyr::recode(term,
                    "Bet Odds" = "Pre-Match Win Probability",
                    "Break Saved1" = "P1 Break Saved",
                    "Break Saved2" = "P2 Break Saved",
                    "Break Converted1" = "P1 Break Converted",
                    "Break Converted2" = "P2 Break Converted",
                    "Set Victor" = "P1 Set Victor",
                    "Set Victor2" = "P2 Set Victor",
                    "Tiebreak Victor" = "P1 Tiebreak Victor",
                    "Tiebreak Victor2" = "P2 Tiebreak Victor",
                    )) %>%
    select(-metric) %>%
    rename_with(str_to_title)
}

prep_linear_tables_appendix(cov_model, cov_model_close, cov_model_men, cov_model_close_men, cov_model_women, cov_model_close_women) %>%
  gt()
  # flextable() %>%
  # align(align = "center", part = "all") %>%
  # merge_v(j = ~Term) %>%
  # add_header_row(
  #   values = c("", "Combined", "Men", "Women"),
  #   colwidths = c(1, 2, 2, 2), top = TRUE) %>%
  # set_header_labels(values = c("Term", "Full", "Reduced", "Full", "Reduced", "Full", "Reduced")) %>%
  # width(j = 1, width = 1.5)
```

```{=latex}
\end{spacing}
```

In @fig-game-assumptions, we test the assumptions for the game-level linear regression. For readability, we take a random sample of 1000 points from the model. This subset appears to meet all the model's assumptions. The first plot demonstrates that the residuals appear to be normally distributed. The second plot addresses the model's linearity conditions. The third plot evaluates the homogeneity of variance. @tbl-game-multicollinearity and @fig-game-correlation-matrix displays the correlation of the covariates. **Sex** and **betting odds** are removed from the correlation matrix for readability. They have no large associations with any of the other covariates. The largest correlation is .805 between **interruption** and **change ends**. There is also a large correlation between **server** and **game victor** (.496). These results are almost identical to that of the reduced model.

```{r, fig.height = 6}
#| label: fig-game-assumptions
#| fig-cap: "Assumptions for Game Level"

# residuals
set.seed(1)
game_residuals <- tibble(residual = game_cov_model$fit$residuals,
                        fitted = game_cov_model$fit$fitted.values) %>%
  sample_n(1000) %>%
  arrange(residual) %>%
  mutate(
    rank = row_number(),
    ordered_values = (residual - mean(residual))/sd(residual),
    sqrt_ordered_values = sqrt(abs(ordered_values)),
    theoretical_quantiles = qnorm(rank/(n() + 1), 0, 1))

# qq plot
qq_game <- game_residuals %>% ggplot() +
  geom_point(aes(theoretical_quantiles, ordered_values), color = "cadetblue4") +
  geom_abline(intercept = 0, slope = 1, color = "indianred3") +
  labs(title = "Q-Q Plot", x = "Theoretical Quantiles", y = "Ordered Values")

# linearity
linear_game <- game_residuals %>% ggplot(aes(fitted, residual)) +
  geom_point(color = "cadetblue3") +
  geom_smooth(color = "forestgreen", se = FALSE) +
  labs(title = "Linearity", x = "Fitted Values", y = "Residuals")

# homogeneity of variance
homogeneity_game <- game_residuals %>% ggplot(aes(fitted, sqrt_ordered_values)) +
  geom_point(color = "cadetblue3") +
  geom_smooth(color = "forestgreen", se = FALSE) +
  labs(title = "Homogeneity of Variance", x = "Fitted Values", y = "Variation")

qq_game/linear_game/homogeneity_game
```

```{=latex}
\begin{spacing}{1}
```

```{r}
#| label: tbl-game-multicollinearity
#| tbl-cap: "Game Level Covariates Multicollinearity"

game_cov_model %>% check_collinearity() %>%
  as_tibble() %>%
  arrange(desc(VIF)) %>%
  select(Term, VIF) %>%
  mutate(across(where(is.numeric), ~round(.x, digits = 4))) %>%
  gt()
  # flextable() %>%
  # align(align = "center", part = "all") %>%
  # width(j = 1, width = 1.5)
```

```{=latex}
\end{spacing}
```

```{r}
#| label: fig-game-correlation-matrix
#| fig-cap: "Game Level Covariates Correlation Matrix"

game_cov_cor <- game_cov %>%
  select(server, game_victor, interruption, change_ends, tiebreak_victor, set_victor) %>%
  mutate(
    across(server:set_victor, ~as.double(.x))) %>%
  correlate()

game_cov_cor %>% rplot(.order = "alphabet") +
  theme(axis.text.x = element_text(angle = 22.5, hjust = 1))
```

In @tbl-game-full-results, we show the full results for the six game level models. The dependent variable is **future momentum**. Many covariates apply for both player 1 and player 2. We use the prefix "P1" to denote player 1 and "P2" to denote player 2 for all such variables.

\bigskip

\medskip

```{=latex}
\begin{spacing}{1}
```

```{r}
#| label: tbl-game-full-results
#| tbl-cap: "Game Level Model Full Results"

prep_linear_tables_appendix(game_cov_model, game_cov_model_close, game_cov_model_men, game_cov_model_close_men, game_cov_model_women, game_cov_model_close_women) %>%
  gt()
  # flextable() %>%
  # align(align = "center", part = "all") %>%
  # merge_v(j = ~Term) %>%
  # add_header_row(
  #   values = c("", "Combined", "Men", "Women"),
  #   colwidths = c(1, 2, 2, 2), top = TRUE) %>%
  # set_header_labels(values = c("Term", "Full", "Reduced", "Full", "Reduced", "Full", "Reduced")) %>%
  # width(j = 1, width = 1.5)
```

```{=latex}
\end{spacing}
```



